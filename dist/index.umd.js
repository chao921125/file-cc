!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("node:util"),require("node:stream"),require("child_process"),require("fs"),require("node:child_process"),require("node:crypto"),require("node:path"),require("node:events"),require("node:os")):"function"==typeof define&&define.amd?define(["exports","node:util","node:stream","child_process","fs","node:child_process","node:crypto","node:path","node:events","node:os"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).FileCC={},e.require$$0$3,e.require$$1$1,e.require$$0$1,e.require$$0,e.require$$0$2,e.require$$1,e.require$$0$4,e.require$$0$5,e.require$$7)}(this,function(e,t,r,i,n,o,a,s,l,h){"use strict";function u(e,t,r,i){return new(r||(r=Promise))(function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}l((i=i.apply(e,t||[])).next())})}function c(e,t){var r,i,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function f(e){var t;if(!e)return"";var r=e.split(".");return r.length>1&&(null===(t=r.pop())||void 0===t?void 0:t.toLowerCase())||""}function p(e){return{"image/jpeg":"jpg","image/jpg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","audio/mpeg":"mp3","audio/mp3":"mp3","audio/wav":"wav","audio/ogg":"ogg","video/mp4":"mp4","video/webm":"webm","video/ogg":"ogv","application/pdf":"pdf","text/plain":"txt","text/html":"html","text/css":"css","text/javascript":"js","application/json":"json"}[e]||""}function d(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp",mp3:"audio/mpeg",wav:"audio/wav",ogg:"audio/ogg",mp4:"video/mp4",webm:"video/webm",ogv:"video/ogg",pdf:"application/pdf",txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json"}[e.toLowerCase()]||"application/octet-stream"}function g(e){void 0===e&&(e="");var t=(new Date).getTime(),r=Math.floor(1e4*Math.random());return"file_".concat(t,"_").concat(r).concat(e?"."+e:"")}function m(e){var t=e.match(/^data:([\w\/+]+);base64,/);return t&&t.length>1?t[1]:""}function b(e){return new Promise(function(t,r){var i=new FileReader;i.onload=function(){"string"==typeof i.result?t(i.result):r(new Error("FileReader结果不是字符串"))},i.onerror=function(){return r(new Error("Blob转Base64失败"))},i.readAsDataURL(e)})}function w(e){var t="application/octet-stream",r=e;e.startsWith("data:")&&(t=m(e)||t,r=e.split(",")[1]);for(var i=atob(r),n=[],o=0;o<i.length;o+=512){for(var a=i.slice(o,o+512),s=new Array(a.length),l=0;l<a.length;l++)s[l]=a.charCodeAt(l);var h=new Uint8Array(s);n.push(h)}return new Blob(n,{type:t})}function v(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var E,y;function x(){if(y)return E;y=1;const e=function(e){return null!=e};return E={defined:e,object:function(e){return"object"==typeof e},plainObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},fn:function(e){return"function"==typeof e},bool:function(e){return"boolean"==typeof e},buffer:function(e){return e instanceof Buffer},typedArray:function(t){if(e(t))switch(t.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},arrayBuffer:function(e){return e instanceof ArrayBuffer},string:function(e){return"string"==typeof e&&e.length>0},number:function(e){return"number"==typeof e&&!Number.isNaN(e)},integer:function(e){return Number.isInteger(e)},inRange:function(e,t,r){return e>=t&&e<=r},inArray:function(e,t){return t.includes(e)},invalidParameterError:function(e,t,r){return new Error(`Expected ${t} for ${e} but received ${r} of type ${typeof r}`)},nativeError:function(e,t){return t.message=e.message,t}}}function P(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}"function"==typeof SuppressedError&&SuppressedError;var O,R,j,I,$,A,L,k,S,M,N={exports:{}};function T(){if(A)return $;A=1;const e=i,{isLinux:t,getReport:r}=function(){if(R)return O;R=1;const e=()=>"linux"===process.platform;let t=null;return O={isLinux:e,getReport:()=>{if(!t)if(e()&&process.report){const e=process.report.excludeNetwork;process.report.excludeNetwork=!0,t=process.report.getReport(),process.report.excludeNetwork=e}else t={};return t}}}(),{LDD_PATH:o,readFile:a,readFileSync:s}=function(){if(I)return j;I=1;const e=n;return j={LDD_PATH:"/usr/bin/ldd",readFileSync:t=>e.readFileSync(t,"utf-8"),readFile:t=>new Promise((r,i)=>{e.readFile(t,"utf-8",(e,t)=>{e?i(e):r(t)})})}}();let l,h;const u="getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true";let c="";const f=()=>c||new Promise(t=>{e.exec(u,(e,r)=>{c=e?" ":r,t(c)})}),p=()=>{if(!c)try{c=e.execSync(u,{encoding:"utf8"})}catch(e){c=" "}return c},d="glibc",g=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,m="musl",b=e=>e.includes("libc.musl-")||e.includes("ld-musl-"),w=()=>{const e=r();return e.header&&e.header.glibcVersionRuntime?d:Array.isArray(e.sharedObjects)&&e.sharedObjects.some(b)?m:null},v=e=>{const[t,r]=e.split(/[\r\n]+/);return t&&t.includes(d)?d:r&&r.includes(m)?m:null},E=e=>e.includes("musl")?m:e.includes("GNU C Library")?d:null,y=async()=>{let e=null;if(t()&&(e=await(async()=>{if(void 0!==l)return l;l=null;try{const e=await a(o);l=E(e)}catch(e){}return l})(),e||(e=w()),!e)){const t=await f();e=v(t)}return e},x=()=>{let e=null;if(t()&&(e=(()=>{if(void 0!==l)return l;l=null;try{const e=s(o);l=E(e)}catch(e){}return l})(),e||(e=w()),!e)){const t=p();e=v(t)}return e},P=()=>{const e=r();return e.header&&e.header.glibcVersionRuntime?e.header.glibcVersionRuntime:null},L=e=>e.trim().split(/\s+/)[1],k=e=>{const[t,r,i]=e.split(/[\r\n]+/);return t&&t.includes(d)?L(t):r&&i&&r.includes(m)?L(i):null};return $={GLIBC:d,MUSL:m,family:y,familySync:x,isNonGlibcLinux:async()=>t()&&await y()!==d,isNonGlibcLinuxSync:()=>t()&&x()!==d,version:async()=>{let e=null;if(t()&&(e=await(async()=>{if(void 0!==h)return h;h=null;try{const e=(await a(o)).match(g);e&&(h=e[1])}catch(e){}return h})(),e||(e=P()),!e)){const t=await f();e=k(t)}return e},versionSync:()=>{let e=null;if(t()&&(e=(()=>{if(void 0!==h)return h;h=null;try{const e=s(o).match(g);e&&(h=e[1])}catch(e){}return h})(),e||(e=P()),!e)){const t=p();e=k(t)}return e}},$}function B(){if(k)return L;k=1;const e="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};return L=e}function _(){if(M)return S;M=1;const e=Number.MAX_SAFE_INTEGER||9007199254740991;return S={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}}var C,F,D,q,U,z,G,W,H,X,Q,V,Y,J,K,Z,ee,te,re,ie,ne,oe,ae,se,le,he,ue,ce,fe,pe,de,ge,me,be,we,ve={exports:{}};function Ee(){return C||(C=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:n}=_(),o=B(),a=(t=e.exports={}).re=[],s=t.safeRe=[],l=t.src=[],h=t.safeSrc=[],u=t.t={};let c=0;const f="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",n],[f,i]],d=(e,t,r)=>{const i=(e=>{for(const[t,r]of p)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),n=c++;o(e,n,t),u[e]=n,l[n]=t,h[n]=i,a[n]=new RegExp(t,r?"g":void 0),s[n]=new RegExp(i,r?"g":void 0)};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","\\d+"),d("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),d("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),d("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASEIDENTIFIER",`(?:${l[u.NONNUMERICIDENTIFIER]}|${l[u.NUMERICIDENTIFIER]})`),d("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NONNUMERICIDENTIFIER]}|${l[u.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),d("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),d("BUILDIDENTIFIER",`${f}+`),d("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),d("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),d("FULL",`^${l[u.FULLPLAIN]}$`),d("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),d("LOOSE",`^${l[u.LOOSEPLAIN]}$`),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),d("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),d("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),d("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),d("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),d("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),d("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),d("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),d("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?`+`(?:${l[u.BUILD]})?(?:$|[^\\d])`),d("COERCERTL",l[u.COERCE],!0),d("COERCERTLFULL",l[u.COERCEFULL],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",d("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),d("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),d("LONECARET","(?:\\^)"),d("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",d("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),d("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),d("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),d("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),d("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),d("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(ve,ve.exports)),ve.exports}function ye(){if(D)return F;D=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return F=r=>r?"object"!=typeof r?e:r:t}function xe(){if(G)return z;G=1;const e=B(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:r}=_(),{safeRe:i,t:n}=Ee(),o=ye(),{compareIdentifiers:a}=function(){if(U)return q;U=1;const e=/^[0-9]+$/,t=(t,r)=>{const i=e.test(t),n=e.test(r);return i&&n&&(t=+t,r=+r),t===r?0:i&&!n?-1:n&&!i?1:t<r?-1:1};return q={compareIdentifiers:t,rcompareIdentifiers:(e,r)=>t(r,e)}}();class s{constructor(a,l){if(l=o(l),a instanceof s){if(a.loose===!!l.loose&&a.includePrerelease===!!l.includePrerelease)return a;a=a.version}else if("string"!=typeof a)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof a}".`);if(a.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",a,l),this.options=l,this.loose=!!l.loose,this.includePrerelease=!!l.includePrerelease;const h=a.trim().match(l.loose?i[n.LOOSE]:i[n.FULL]);if(!h)throw new TypeError(`Invalid Version: ${a}`);if(this.raw=a,this.major=+h[1],this.minor=+h[2],this.patch=+h[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");h[4]?this.prerelease=h[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e}):this.prerelease=[],this.build=h[5]?h[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(e("SemVer.compare",this.version,this.options,t),!(t instanceof s)){if("string"==typeof t&&t===this.version)return 0;t=new s(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(e){return e instanceof s||(e=new s(e,this.options)),a(this.major,e.major)||a(this.minor,e.minor)||a(this.patch,e.patch)}comparePre(t){if(t instanceof s||(t=new s(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const i=this.prerelease[r],n=t.prerelease[r];if(e("prerelease compare",r,i,n),void 0===i&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===i)return-1;if(i!==n)return a(i,n)}while(++r)}compareBuild(t){t instanceof s||(t=new s(t,this.options));let r=0;do{const i=this.build[r],n=t.build[r];if(e("build compare",r,i,n),void 0===i&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===i)return-1;if(i!==n)return a(i,n)}while(++r)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?i[n.PRERELEASELOOSE]:i[n.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let i=this.prerelease.length;for(;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);if(-1===i){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let i=[t,e];!1===r&&(i=[t]),0===a(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return z=s}function Pe(){if(Q)return X;Q=1;const e=xe(),t=function(){if(H)return W;H=1;const e=xe();return W=(t,r,i=!1)=>{if(t instanceof e)return t;try{return new e(t,r)}catch(e){if(!i)return null;throw e}},W}(),{safeRe:r,t:i}=Ee();return X=(n,o)=>{if(n instanceof e)return n;if("number"==typeof n&&(n=String(n)),"string"!=typeof n)return null;let a=null;if((o=o||{}).rtl){const e=o.includePrerelease?r[i.COERCERTLFULL]:r[i.COERCERTL];let t;for(;(t=e.exec(n))&&(!a||a.index+a[0].length!==n.length);)a&&t.index+t[0].length===a.index+a[0].length||(a=t),e.lastIndex=t.index+t[1].length+t[2].length;e.lastIndex=-1}else a=n.match(o.includePrerelease?r[i.COERCEFULL]:r[i.COERCE]);if(null===a)return null;const s=a[2],l=a[3]||"0",h=a[4]||"0",u=o.includePrerelease&&a[5]?`-${a[5]}`:"",c=o.includePrerelease&&a[6]?`+${a[6]}`:"";return t(`${s}.${l}.${h}${u}${c}`,o)},X}function Oe(){if(Y)return V;Y=1;const e=xe();return V=(t,r,i)=>new e(t,i).compare(new e(r,i))}function Re(){if(K)return J;K=1;const e=Oe();return J=(t,r,i)=>e(t,r,i)>=0}function je(){if(fe)return ce;fe=1;const e=function(){if(re)return te;re=1;const e=Oe();return te=(t,r,i)=>0===e(t,r,i)}(),t=function(){if(ne)return ie;ne=1;const e=Oe();return ie=(t,r,i)=>0!==e(t,r,i)}(),r=function(){if(ae)return oe;ae=1;const e=Oe();return oe=(t,r,i)=>e(t,r,i)>0}(),i=Re(),n=function(){if(le)return se;le=1;const e=Oe();return se=(t,r,i)=>e(t,r,i)<0}(),o=function(){if(ue)return he;ue=1;const e=Oe();return he=(t,r,i)=>e(t,r,i)<=0}();return ce=(a,s,l,h)=>{switch(s){case"===":return"object"==typeof a&&(a=a.version),"object"==typeof l&&(l=l.version),a===l;case"!==":return"object"==typeof a&&(a=a.version),"object"==typeof l&&(l=l.version),a!==l;case"":case"=":case"==":return e(a,l,h);case"!=":return t(a,l,h);case">":return r(a,l,h);case">=":return i(a,l,h);case"<":return n(a,l,h);case"<=":return o(a,l,h);default:throw new TypeError(`Invalid operator: ${s}`)}}}function Ie(){if(me)return ge;me=1;const e=/\s+/g;class t{constructor(r,o){if(o=i(o),r instanceof t)return r.loose===!!o.loose&&r.includePrerelease===!!o.includePrerelease?r:new t(r.raw,o);if(r instanceof n)return this.raw=r.value,this.set=[[r]],this.formatted=void 0,this;if(this.options=o,this.loose=!!o.loose,this.includePrerelease=!!o.includePrerelease,this.raw=r.trim().replace(e," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!d(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&g(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&f)|(this.options.loose&&p))+":"+e,i=r.get(t);if(i)return i;const a=this.options.loose,g=a?s[l.HYPHENRANGELOOSE]:s[l.HYPHENRANGE];e=e.replace(g,I(this.options.includePrerelease)),o("hyphen replace",e),e=e.replace(s[l.COMPARATORTRIM],h),o("comparator trim",e),e=e.replace(s[l.TILDETRIM],u),o("tilde trim",e),e=e.replace(s[l.CARETTRIM],c),o("caret trim",e);let m=e.split(" ").map(e=>b(e,this.options)).join(" ").split(/\s+/).map(e=>j(e,this.options));a&&(m=m.filter(e=>(o("loose invalid filter",e,this.options),!!e.match(s[l.COMPARATORLOOSE])))),o("range list",m);const w=new Map,v=m.map(e=>new n(e,this.options));for(const e of v){if(d(e))return[e];w.set(e.value,e)}w.size>1&&w.has("")&&w.delete("");const E=[...w.values()];return r.set(t,E),E}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(t=>m(t,r)&&e.set.some(e=>m(e,r)&&t.every(t=>e.every(e=>t.intersects(e,r)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new a(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if($(this.set[t],e,this.options))return!0;return!1}}ge=t;const r=new(ee?Z:(ee=1,Z=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}})),i=ye(),n=function(){if(de)return pe;de=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(i,n){if(n=r(n),i instanceof t){if(i.loose===!!n.loose)return i;i=i.value}i=i.trim().split(/\s+/).join(" "),a("comparator",i,n),this.options=n,this.loose=!!n.loose,this.parse(i),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(t){const r=this.options.loose?i[n.COMPARATORLOOSE]:i[n.COMPARATOR],o=t.match(r);if(!o)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==o[1]?o[1]:"","="===this.operator&&(this.operator=""),o[2]?this.semver=new s(o[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(a("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new s(t,this.options)}catch(e){return!1}return o(t,this.operator,this.semver,this.options)}intersects(e,i){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new l(e.value,i).test(this.value):""===e.operator?""===e.value||new l(this.value,i).test(e.semver):!((i=r(i)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!i.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(o(this.semver,"<",e.semver,i)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(o(this.semver,">",e.semver,i)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}pe=t;const r=ye(),{safeRe:i,t:n}=Ee(),o=je(),a=B(),s=xe(),l=Ie();return pe}(),o=B(),a=xe(),{safeRe:s,t:l,comparatorTrimReplace:h,tildeTrimReplace:u,caretTrimReplace:c}=Ee(),{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:p}=_(),d=e=>"<0.0.0-0"===e.value,g=e=>""===e.value,m=(e,t)=>{let r=!0;const i=e.slice();let n=i.pop();for(;r&&i.length;)r=i.every(e=>n.intersects(e,t)),n=i.pop();return r},b=(e,t)=>(o("comp",e,t),e=y(e,t),o("caret",e),e=v(e,t),o("tildes",e),e=P(e,t),o("xrange",e),e=R(e,t),o("stars",e),e),w=e=>!e||"x"===e.toLowerCase()||"*"===e,v=(e,t)=>e.trim().split(/\s+/).map(e=>E(e,t)).join(" "),E=(e,t)=>{const r=t.loose?s[l.TILDELOOSE]:s[l.TILDE];return e.replace(r,(t,r,i,n,a)=>{let s;return o("tilde",e,t,r,i,n,a),w(r)?s="":w(i)?s=`>=${r}.0.0 <${+r+1}.0.0-0`:w(n)?s=`>=${r}.${i}.0 <${r}.${+i+1}.0-0`:a?(o("replaceTilde pr",a),s=`>=${r}.${i}.${n}-${a} <${r}.${+i+1}.0-0`):s=`>=${r}.${i}.${n} <${r}.${+i+1}.0-0`,o("tilde return",s),s})},y=(e,t)=>e.trim().split(/\s+/).map(e=>x(e,t)).join(" "),x=(e,t)=>{o("caret",e,t);const r=t.loose?s[l.CARETLOOSE]:s[l.CARET],i=t.includePrerelease?"-0":"";return e.replace(r,(t,r,n,a,s)=>{let l;return o("caret",e,t,r,n,a,s),w(r)?l="":w(n)?l=`>=${r}.0.0${i} <${+r+1}.0.0-0`:w(a)?l="0"===r?`>=${r}.${n}.0${i} <${r}.${+n+1}.0-0`:`>=${r}.${n}.0${i} <${+r+1}.0.0-0`:s?(o("replaceCaret pr",s),l="0"===r?"0"===n?`>=${r}.${n}.${a}-${s} <${r}.${n}.${+a+1}-0`:`>=${r}.${n}.${a}-${s} <${r}.${+n+1}.0-0`:`>=${r}.${n}.${a}-${s} <${+r+1}.0.0-0`):(o("no pr"),l="0"===r?"0"===n?`>=${r}.${n}.${a}${i} <${r}.${n}.${+a+1}-0`:`>=${r}.${n}.${a}${i} <${r}.${+n+1}.0-0`:`>=${r}.${n}.${a} <${+r+1}.0.0-0`),o("caret return",l),l})},P=(e,t)=>(o("replaceXRanges",e,t),e.split(/\s+/).map(e=>O(e,t)).join(" ")),O=(e,t)=>{e=e.trim();const r=t.loose?s[l.XRANGELOOSE]:s[l.XRANGE];return e.replace(r,(r,i,n,a,s,l)=>{o("xRange",e,r,i,n,a,s,l);const h=w(n),u=h||w(a),c=u||w(s),f=c;return"="===i&&f&&(i=""),l=t.includePrerelease?"-0":"",h?r=">"===i||"<"===i?"<0.0.0-0":"*":i&&f?(u&&(a=0),s=0,">"===i?(i=">=",u?(n=+n+1,a=0,s=0):(a=+a+1,s=0)):"<="===i&&(i="<",u?n=+n+1:a=+a+1),"<"===i&&(l="-0"),r=`${i+n}.${a}.${s}${l}`):u?r=`>=${n}.0.0${l} <${+n+1}.0.0-0`:c&&(r=`>=${n}.${a}.0${l} <${n}.${+a+1}.0-0`),o("xRange return",r),r})},R=(e,t)=>(o("replaceStars",e,t),e.trim().replace(s[l.STAR],"")),j=(e,t)=>(o("replaceGTE0",e,t),e.trim().replace(s[t.includePrerelease?l.GTE0PRE:l.GTE0],"")),I=e=>(t,r,i,n,o,a,s,l,h,u,c,f)=>`${r=w(i)?"":w(n)?`>=${i}.0.0${e?"-0":""}`:w(o)?`>=${i}.${n}.0${e?"-0":""}`:a?`>=${r}`:`>=${r}${e?"-0":""}`} ${l=w(h)?"":w(u)?`<${+h+1}.0.0-0`:w(c)?`<${h}.${+u+1}.0-0`:f?`<=${h}.${u}.${c}-${f}`:e?`<${h}.${u}.${+c+1}-0`:`<=${l}`}`.trim(),$=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(o(e[r].semver),e[r].semver!==n.ANY&&e[r].semver.prerelease.length>0){const i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0};return ge}var $e,Ae,Le,ke,Se,Me,Ne,Te,Be,_e,Ce,Fe,De,qe={version:"0.34.2",optionalDependencies:{"@img/sharp-darwin-arm64":"0.34.2","@img/sharp-darwin-x64":"0.34.2","@img/sharp-libvips-darwin-arm64":"1.1.0","@img/sharp-libvips-darwin-x64":"1.1.0","@img/sharp-libvips-linux-arm":"1.1.0","@img/sharp-libvips-linux-arm64":"1.1.0","@img/sharp-libvips-linux-ppc64":"1.1.0","@img/sharp-libvips-linux-s390x":"1.1.0","@img/sharp-libvips-linux-x64":"1.1.0","@img/sharp-libvips-linuxmusl-arm64":"1.1.0","@img/sharp-libvips-linuxmusl-x64":"1.1.0","@img/sharp-linux-arm":"0.34.2","@img/sharp-linux-arm64":"0.34.2","@img/sharp-linux-s390x":"0.34.2","@img/sharp-linux-x64":"0.34.2","@img/sharp-linuxmusl-arm64":"0.34.2","@img/sharp-linuxmusl-x64":"0.34.2","@img/sharp-wasm32":"0.34.2","@img/sharp-win32-arm64":"0.34.2","@img/sharp-win32-ia32":"0.34.2","@img/sharp-win32-x64":"0.34.2"},engines:{node:"^18.17.0 || ^20.3.0 || >=21.0.0"},config:{libvips:">=8.16.1"}};function Ue(){if(Ae)return $e;Ae=1;const{spawnSync:e}=o,{createHash:t}=a,r=Pe(),i=Re(),n=function(){if(we)return be;we=1;const e=Ie();return be=(t,r,i)=>{try{r=new e(r,i)}catch(e){return!1}return r.test(t)},be}(),s=T(),{config:l,engines:h,optionalDependencies:u}=qe,c=process.env.npm_package_config_libvips||l.libvips,f=r(c).version,p={encoding:"utf8",shell:!0},d=()=>s.isNonGlibcLinuxSync()?s.familySync():"",g=()=>{if(m())return"wasm32";const{npm_config_arch:e,npm_config_platform:t,npm_config_libc:r}=process.env,i="string"==typeof r?r:d();return`${t||process.platform}${i}-${e||process.arch}`},m=()=>{const{CC:e}=process.env;return Boolean(e&&e.endsWith("/emcc"))},b=e=>t("sha512").update(e).digest("hex"),w=()=>{if("win32"!==process.platform){return(e("pkg-config --modversion vips-cpp",{...p,env:{...process.env,PKG_CONFIG_PATH:v()}}).stdout||"").trim()}return""},v=()=>{if("win32"!==process.platform){return[(e('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',p).stdout||"").trim(),process.env.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":")}return""},E=(e,t,r)=>(r&&r(`Detected ${t}, skipping search for globally-installed libvips`),e);return $e={minimumLibvipsVersion:f,prebuiltPlatforms:["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-ppc64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-arm64","win32-ia32","win32-x64"],buildPlatformArch:g,buildSharpLibvipsIncludeDir:()=>{try{return P(`@img/sharp-libvips-dev-${g()}/include`)}catch{try{return require("@img/sharp-libvips-dev/include")}catch{}}return""},buildSharpLibvipsCPlusPlusDir:()=>{try{return require("@img/sharp-libvips-dev/cplusplus")}catch{}return""},buildSharpLibvipsLibDir:()=>{try{return P(`@img/sharp-libvips-dev-${g()}/lib`)}catch{try{return P(`@img/sharp-libvips-${g()}/lib`)}catch{}}return""},isUnsupportedNodeRuntime:()=>{if("node"===process.release?.name&&process.versions&&!n(process.versions.node,h.node))return{found:process.versions.node,expected:h.node}},runtimePlatformArch:()=>`${process.platform}${d()}-${process.arch}`,log:e=>{e instanceof Error?console.error(`sharp: Installation error: ${e.message}`):console.log(`sharp: ${e}`)},yarnLocator:()=>{try{const e=b(`imgsharp-libvips-${g()}`),t=r(u[`@img/sharp-libvips-${g()}`],{includePrerelease:!0}).version;return b(`${e}npm:${t}`).slice(0,10)}catch{}return""},spawnRebuild:()=>e("node-gyp rebuild --directory=src "+(m()?"--nodedir=emscripten":""),{...p,stdio:"inherit"}).status,globalLibvipsVersion:w,pkgConfigPath:v,useGlobalLibvips:t=>{if(!0===Boolean(process.env.SHARP_IGNORE_GLOBAL_LIBVIPS))return E(!1,"SHARP_IGNORE_GLOBAL_LIBVIPS",t);if(!0===Boolean(process.env.SHARP_FORCE_GLOBAL_LIBVIPS))return E(!0,"SHARP_FORCE_GLOBAL_LIBVIPS",t);if((()=>{if("darwin"===process.platform&&"x64"===process.arch)return"sysctl.proc_translated: 1"===(e("sysctl sysctl.proc_translated",p).stdout||"").trim();return!1})())return E(!1,"Rosetta",t);const r=w();return!!r&&i(r,f)}}}function ze(){if(Le)return N.exports;Le=1;const{familySync:e,versionSync:t}=T(),{runtimePlatformArch:r,isUnsupportedNodeRuntime:i,prebuiltPlatforms:n,minimumLibvipsVersion:o}=Ue(),a=r(),s=[`../src/build/Release/sharp-${a}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${a}/sharp.node`,"@img/sharp-wasm32/sharp.node"];let l,h;const u=[];for(l of s)try{h=P(l);break}catch(e){u.push(e)}if(h&&l.startsWith("@img/sharp-linux-x64")&&!h._isUsingX64V2()){const e=new Error("Prebuilt binaries for linux-x64 require v2 microarchitecture");e.code="Unsupported CPU",u.push(e),h=null}if(!h){const[r,s,l]=["linux","darwin","win32"].map(e=>a.startsWith(e)),h=[`Could not load the "sharp" module using the ${a} runtime`];u.forEach(e=>{"MODULE_NOT_FOUND"!==e.code&&h.push(`${e.code}: ${e.message}`)});const c=u.map(e=>e.message).join(" ");if(h.push("Possible solutions:"),i()){const{found:e,expected:t}=i();h.push("- Please upgrade Node.js:",`    Found ${e}`,`    Requires ${t}`)}else if(n.includes(a)){const[e,t]=a.split("-"),r=e.endsWith("musl")?" --libc=musl":"";h.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${e.replace("musl","")}${r} --cpu=${t} sharp`)}else h.push(`- Manually install libvips >= ${o}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32");if(r&&/(symbol not found|CXXABI_)/i.test(c))try{const{config:r}=P(`@img/sharp-libvips-${a}/package`),i=`${e()} ${t()}`,n=`${r.musl?"musl":"glibc"} ${r.musl||r.glibc}`;h.push("- Update your OS:",`    Found ${i}`,`    Requires ${n}`)}catch(e){}throw r&&/\/snap\/core[0-9]{2}/.test(c)&&h.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node"),s&&/Incompatible library version/.test(c)&&h.push("- Update Homebrew:","    brew update && brew upgrade vips"),u.some(e=>"ERR_DLOPEN_DISABLED"===e.code)&&h.push("- Run Node.js without using the --no-addons flag"),l&&/The specified procedure could not be found/.test(c)&&h.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp"),h.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install"),new Error(h.join("\n"))}return N.exports=h,N.exports}var Ge,We,He={exports:{}};function Xe(){return We?Ge:(We=1,Ge={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]})}var Qe,Ve,Ye,Je,Ke,Ze,et,tt,rt,it,nt,ot,at,st,lt,ht,ut,ct,ft,pt,dt,gt,mt={exports:{}};function bt(){return Ve?Qe:(Ve=1,Qe=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))})}function wt(){if(Je)return He.exports;Je=1;var e=Xe(),t=function(){if(Ye)return mt.exports;Ye=1;var e=bt(),t=Array.prototype.concat,r=Array.prototype.slice,i=mt.exports=function(i){for(var n=[],o=0,a=i.length;o<a;o++){var s=i[o];e(s)?n=t.call(n,r.call(s)):n.push(s)}return n};return i.wrap=function(e){return function(){return e(i(arguments))}},mt.exports}(),r=Object.hasOwnProperty,i=Object.create(null);for(var n in e)r.call(e,n)&&(i[e[n]]=n);var o=He.exports={to:{},get:{}};function a(e,t,r){return Math.min(Math.max(t,e),r)}function s(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}return o.get=function(e){var t,r;switch(e.substring(0,3).toLowerCase()){case"hsl":t=o.get.hsl(e),r="hsl";break;case"hwb":t=o.get.hwb(e),r="hwb";break;default:t=o.get.rgb(e),r="rgb"}return t?{model:r,value:t}:null},o.get.rgb=function(t){if(!t)return null;var i,n,o,s=[0,0,0,1];if(i=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(o=i[2],i=i[1],n=0;n<3;n++){var l=2*n;s[n]=parseInt(i.slice(l,l+2),16)}o&&(s[3]=parseInt(o,16)/255)}else if(i=t.match(/^#([a-f0-9]{3,4})$/i)){for(o=(i=i[1])[3],n=0;n<3;n++)s[n]=parseInt(i[n]+i[n],16);o&&(s[3]=parseInt(o+o,16)/255)}else if(i=t.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)s[n]=parseInt(i[n+1],0);i[4]&&(i[5]?s[3]=.01*parseFloat(i[4]):s[3]=parseFloat(i[4]))}else{if(!(i=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(i=t.match(/^(\w+)$/))?"transparent"===i[1]?[0,0,0,0]:r.call(e,i[1])?((s=e[i[1]])[3]=1,s):null:null;for(n=0;n<3;n++)s[n]=Math.round(2.55*parseFloat(i[n+1]));i[4]&&(i[5]?s[3]=.01*parseFloat(i[4]):s[3]=parseFloat(i[4]))}for(n=0;n<3;n++)s[n]=a(s[n],0,255);return s[3]=a(s[3],0,1),s},o.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,a(parseFloat(t[2]),0,100),a(parseFloat(t[3]),0,100),a(isNaN(r)?1:r,0,1)]}return null},o.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,a(parseFloat(t[2]),0,100),a(parseFloat(t[3]),0,100),a(isNaN(r)?1:r,0,1)]}return null},o.to.hex=function(){var e=t(arguments);return"#"+s(e[0])+s(e[1])+s(e[2])+(e[3]<1?s(Math.round(255*e[3])):"")},o.to.rgb=function(){var e=t(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},o.to.rgb.percent=function(){var e=t(arguments),r=Math.round(e[0]/255*100),i=Math.round(e[1]/255*100),n=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+r+"%, "+i+"%, "+n+"%)":"rgba("+r+"%, "+i+"%, "+n+"%, "+e[3]+")"},o.to.hsl=function(){var e=t(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},o.to.hwb=function(){var e=t(arguments),r="";return e.length>=4&&1!==e[3]&&(r=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+r+")"},o.to.keyword=function(e){return i[e.slice(0,3)]},He.exports}function vt(){if(Ze)return Ke;Ze=1;const e=Xe(),t={};for(const r of Object.keys(e))t[e[r]]=r;const r={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};Ke=r;for(const e of Object.keys(r)){if(!("channels"in r[e]))throw new Error("missing channels property: "+e);if(!("labels"in r[e]))throw new Error("missing channel labels property: "+e);if(r[e].labels.length!==r[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:i}=r[e];delete r[e].channels,delete r[e].labels,Object.defineProperty(r[e],"channels",{value:t}),Object.defineProperty(r[e],"labels",{value:i})}function i(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}return r.rgb.hsl=function(e){const t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.min(t,r,i),o=Math.max(t,r,i),a=o-n;let s,l;o===n?s=0:t===o?s=(r-i)/a:r===o?s=2+(i-t)/a:i===o&&(s=4+(t-r)/a),s=Math.min(60*s,360),s<0&&(s+=360);const h=(n+o)/2;return l=o===n?0:h<=.5?a/(o+n):a/(2-o-n),[s,100*l,100*h]},r.rgb.hsv=function(e){let t,r,i,n,o;const a=e[0]/255,s=e[1]/255,l=e[2]/255,h=Math.max(a,s,l),u=h-Math.min(a,s,l),c=function(e){return(h-e)/6/u+.5};return 0===u?(n=0,o=0):(o=u/h,t=c(a),r=c(s),i=c(l),a===h?n=i-r:s===h?n=1/3+t-i:l===h&&(n=2/3+r-t),n<0?n+=1:n>1&&(n-=1)),[360*n,100*o,100*h]},r.rgb.hwb=function(e){const t=e[0],i=e[1];let n=e[2];const o=r.rgb.hsl(e)[0],a=1/255*Math.min(t,Math.min(i,n));return n=1-1/255*Math.max(t,Math.max(i,n)),[o,100*a,100*n]},r.rgb.cmyk=function(e){const t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.min(1-t,1-r,1-i);return[100*((1-t-n)/(1-n)||0),100*((1-r-n)/(1-n)||0),100*((1-i-n)/(1-n)||0),100*n]},r.rgb.keyword=function(r){const n=t[r];if(n)return n;let o,a=1/0;for(const t of Object.keys(e)){const n=i(r,e[t]);n<a&&(a=n,o=t)}return o},r.keyword.rgb=function(t){return e[t]},r.rgb.xyz=function(e){let t=e[0]/255,r=e[1]/255,i=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92;return[100*(.4124*t+.3576*r+.1805*i),100*(.2126*t+.7152*r+.0722*i),100*(.0193*t+.1192*r+.9505*i)]},r.rgb.lab=function(e){const t=r.rgb.xyz(e);let i=t[0],n=t[1],o=t[2];i/=95.047,n/=100,o/=108.883,i=i>.008856?i**(1/3):7.787*i+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,o=o>.008856?o**(1/3):7.787*o+16/116;return[116*n-16,500*(i-n),200*(n-o)]},r.hsl.rgb=function(e){const t=e[0]/360,r=e[1]/100,i=e[2]/100;let n,o,a;if(0===r)return a=255*i,[a,a,a];n=i<.5?i*(1+r):i+r-i*r;const s=2*i-n,l=[0,0,0];for(let e=0;e<3;e++)o=t+1/3*-(e-1),o<0&&o++,o>1&&o--,a=6*o<1?s+6*(n-s)*o:2*o<1?n:3*o<2?s+(n-s)*(2/3-o)*6:s,l[e]=255*a;return l},r.hsl.hsv=function(e){const t=e[0];let r=e[1]/100,i=e[2]/100,n=r;const o=Math.max(i,.01);i*=2,r*=i<=1?i:2-i,n*=o<=1?o:2-o;return[t,100*(0===i?2*n/(o+n):2*r/(i+r)),100*((i+r)/2)]},r.hsv.rgb=function(e){const t=e[0]/60,r=e[1]/100;let i=e[2]/100;const n=Math.floor(t)%6,o=t-Math.floor(t),a=255*i*(1-r),s=255*i*(1-r*o),l=255*i*(1-r*(1-o));switch(i*=255,n){case 0:return[i,l,a];case 1:return[s,i,a];case 2:return[a,i,l];case 3:return[a,s,i];case 4:return[l,a,i];case 5:return[i,a,s]}},r.hsv.hsl=function(e){const t=e[0],r=e[1]/100,i=e[2]/100,n=Math.max(i,.01);let o,a;a=(2-r)*i;const s=(2-r)*n;return o=r*n,o/=s<=1?s:2-s,o=o||0,a/=2,[t,100*o,100*a]},r.hwb.rgb=function(e){const t=e[0]/360;let r=e[1]/100,i=e[2]/100;const n=r+i;let o;n>1&&(r/=n,i/=n);const a=Math.floor(6*t),s=1-i;o=6*t-a,1&a&&(o=1-o);const l=r+o*(s-r);let h,u,c;switch(a){default:case 6:case 0:h=s,u=l,c=r;break;case 1:h=l,u=s,c=r;break;case 2:h=r,u=s,c=l;break;case 3:h=r,u=l,c=s;break;case 4:h=l,u=r,c=s;break;case 5:h=s,u=r,c=l}return[255*h,255*u,255*c]},r.cmyk.rgb=function(e){const t=e[0]/100,r=e[1]/100,i=e[2]/100,n=e[3]/100;return[255*(1-Math.min(1,t*(1-n)+n)),255*(1-Math.min(1,r*(1-n)+n)),255*(1-Math.min(1,i*(1-n)+n))]},r.xyz.rgb=function(e){const t=e[0]/100,r=e[1]/100,i=e[2]/100;let n,o,a;return n=3.2406*t+-1.5372*r+-.4986*i,o=-.9689*t+1.8758*r+.0415*i,a=.0557*t+-.204*r+1.057*i,n=n>.0031308?1.055*n**(1/2.4)-.055:12.92*n,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,a=a>.0031308?1.055*a**(1/2.4)-.055:12.92*a,n=Math.min(Math.max(0,n),1),o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),[255*n,255*o,255*a]},r.xyz.lab=function(e){let t=e[0],r=e[1],i=e[2];t/=95.047,r/=100,i/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;return[116*r-16,500*(t-r),200*(r-i)]},r.lab.xyz=function(e){let t,r,i;r=(e[0]+16)/116,t=e[1]/500+r,i=r-e[2]/200;const n=r**3,o=t**3,a=i**3;return r=n>.008856?n:(r-16/116)/7.787,t=o>.008856?o:(t-16/116)/7.787,i=a>.008856?a:(i-16/116)/7.787,t*=95.047,r*=100,i*=108.883,[t,r,i]},r.lab.lch=function(e){const t=e[0],r=e[1],i=e[2];let n;n=360*Math.atan2(i,r)/2/Math.PI,n<0&&(n+=360);return[t,Math.sqrt(r*r+i*i),n]},r.lch.lab=function(e){const t=e[0],r=e[1],i=e[2]/360*2*Math.PI;return[t,r*Math.cos(i),r*Math.sin(i)]},r.rgb.ansi16=function(e,t=null){const[i,n,o]=e;let a=null===t?r.rgb.hsv(e)[2]:t;if(a=Math.round(a/50),0===a)return 30;let s=30+(Math.round(o/255)<<2|Math.round(n/255)<<1|Math.round(i/255));return 2===a&&(s+=60),s},r.hsv.ansi16=function(e){return r.rgb.ansi16(r.hsv.rgb(e),e[2])},r.rgb.ansi256=function(e){const t=e[0],r=e[1],i=e[2];if(t===r&&r===i)return t<8?16:t>248?231:Math.round((t-8)/247*24)+232;return 16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(i/255*5)},r.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const r=.5*(1+~~(e>50));return[(1&t)*r*255,(t>>1&1)*r*255,(t>>2&1)*r*255]},r.ansi256.rgb=function(e){if(e>=232){const t=10*(e-232)+8;return[t,t,t]}let t;e-=16;return[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},r.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},r.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let r=t[0];3===t[0].length&&(r=r.split("").map(e=>e+e).join(""));const i=parseInt(r,16);return[i>>16&255,i>>8&255,255&i]},r.rgb.hcg=function(e){const t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.max(Math.max(t,r),i),o=Math.min(Math.min(t,r),i),a=n-o;let s,l;return s=a<1?o/(1-a):0,l=a<=0?0:n===t?(r-i)/a%6:n===r?2+(i-t)/a:4+(t-r)/a,l/=6,l%=1,[360*l,100*a,100*s]},r.hsl.hcg=function(e){const t=e[1]/100,r=e[2]/100,i=r<.5?2*t*r:2*t*(1-r);let n=0;return i<1&&(n=(r-.5*i)/(1-i)),[e[0],100*i,100*n]},r.hsv.hcg=function(e){const t=e[1]/100,r=e[2]/100,i=t*r;let n=0;return i<1&&(n=(r-i)/(1-i)),[e[0],100*i,100*n]},r.hcg.rgb=function(e){const t=e[0]/360,r=e[1]/100,i=e[2]/100;if(0===r)return[255*i,255*i,255*i];const n=[0,0,0],o=t%1*6,a=o%1,s=1-a;let l=0;switch(Math.floor(o)){case 0:n[0]=1,n[1]=a,n[2]=0;break;case 1:n[0]=s,n[1]=1,n[2]=0;break;case 2:n[0]=0,n[1]=1,n[2]=a;break;case 3:n[0]=0,n[1]=s,n[2]=1;break;case 4:n[0]=a,n[1]=0,n[2]=1;break;default:n[0]=1,n[1]=0,n[2]=s}return l=(1-r)*i,[255*(r*n[0]+l),255*(r*n[1]+l),255*(r*n[2]+l)]},r.hcg.hsv=function(e){const t=e[1]/100,r=t+e[2]/100*(1-t);let i=0;return r>0&&(i=t/r),[e[0],100*i,100*r]},r.hcg.hsl=function(e){const t=e[1]/100,r=e[2]/100*(1-t)+.5*t;let i=0;return r>0&&r<.5?i=t/(2*r):r>=.5&&r<1&&(i=t/(2*(1-r))),[e[0],100*i,100*r]},r.hcg.hwb=function(e){const t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],100*(r-t),100*(1-r)]},r.hwb.hcg=function(e){const t=e[1]/100,r=1-e[2]/100,i=r-t;let n=0;return i<1&&(n=(r-i)/(1-i)),[e[0],100*i,100*n]},r.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},r.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},r.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},r.gray.hsl=function(e){return[0,0,e[0]]},r.gray.hsv=r.gray.hsl,r.gray.hwb=function(e){return[0,100,e[0]]},r.gray.cmyk=function(e){return[0,0,0,e[0]]},r.gray.lab=function(e){return[e[0],0,0]},r.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),r=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(r.length)+r},r.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]},Ke}function Et(){if(tt)return et;tt=1;const e=vt();function t(t){const r=function(){const t={},r=Object.keys(e);for(let e=r.length,i=0;i<e;i++)t[r[i]]={distance:-1,parent:null};return t}(),i=[t];for(r[t].distance=0;i.length;){const t=i.pop(),n=Object.keys(e[t]);for(let e=n.length,o=0;o<e;o++){const e=n[o],a=r[e];-1===a.distance&&(a.distance=r[t].distance+1,a.parent=t,i.unshift(e))}}return r}function r(e,t){return function(r){return t(e(r))}}function i(t,i){const n=[i[t].parent,t];let o=e[i[t].parent][t],a=i[t].parent;for(;i[a].parent;)n.unshift(i[a].parent),o=r(e[i[a].parent][a],o),a=i[a].parent;return o.conversion=n,o}return et=function(e){const r=t(e),n={},o=Object.keys(r);for(let e=o.length,t=0;t<e;t++){const e=o[t];null!==r[e].parent&&(n[e]=i(e,r))}return n}}function yt(){if(it)return rt;it=1;const e=vt(),t=Et(),r={};return Object.keys(e).forEach(i=>{r[i]={},Object.defineProperty(r[i],"channels",{value:e[i].channels}),Object.defineProperty(r[i],"labels",{value:e[i].labels});const n=t(i);Object.keys(n).forEach(e=>{const t=n[e];r[i][e]=function(e){const t=function(...t){const r=t[0];if(null==r)return r;r.length>1&&(t=r);const i=e(t);if("object"==typeof i)for(let e=i.length,t=0;t<e;t++)i[t]=Math.round(i[t]);return i};return"conversion"in e&&(t.conversion=e.conversion),t}(t),r[i][e].raw=function(e){const t=function(...t){const r=t[0];return null==r?r:(r.length>1&&(t=r),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(t)})}),rt=r}function xt(){if(ot)return nt;ot=1;const e=wt(),t=yt(),r=["keyword","gray","hex"],i={};for(const e of Object.keys(t))i[[...t[e].labels].sort().join("")]=e;const n={};function o(a,s){if(!(this instanceof o))return new o(a,s);if(s&&s in r&&(s=null),s&&!(s in t))throw new Error("Unknown model: "+s);let l,u;if(null==a)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(a instanceof o)this.model=a.model,this.color=[...a.color],this.valpha=a.valpha;else if("string"==typeof a){const r=e.get(a);if(null===r)throw new Error("Unable to parse color from string: "+a);this.model=r.model,u=t[this.model].channels,this.color=r.value.slice(0,u),this.valpha="number"==typeof r.value[u]?r.value[u]:1}else if(a.length>0){this.model=s||"rgb",u=t[this.model].channels;const e=Array.prototype.slice.call(a,0,u);this.color=h(e,u),this.valpha="number"==typeof a[u]?a[u]:1}else if("number"==typeof a)this.model="rgb",this.color=[a>>16&255,a>>8&255,255&a],this.valpha=1;else{this.valpha=1;const e=Object.keys(a);"alpha"in a&&(e.splice(e.indexOf("alpha"),1),this.valpha="number"==typeof a.alpha?a.alpha:0);const r=e.sort().join("");if(!(r in i))throw new Error("Unable to parse color from object: "+JSON.stringify(a));this.model=i[r];const{labels:n}=t[this.model],o=[];for(l=0;l<n.length;l++)o.push(a[n[l]]);this.color=h(o)}if(n[this.model])for(u=t[this.model].channels,l=0;l<u;l++){const e=n[this.model][l];e&&(this.color[l]=e(this.color[l]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}o.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(t){let r=this.model in e.to?this:this.rgb();r=r.round("number"==typeof t?t:1);const i=1===r.valpha?r.color:[...r.color,this.valpha];return e.to[r.model](i)},percentString(t){const r=this.rgb().round("number"==typeof t?t:1),i=1===r.valpha?r.color:[...r.color,this.valpha];return e.to.rgb.percent(i)},array(){return 1===this.valpha?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:r}=t[this.model],{labels:i}=t[this.model];for(let t=0;t<r;t++)e[i[t]]=this.color[t];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new o([...this.color.map(a(e)),this.valpha],this.model)},alpha(e){return void 0!==e?new o([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:s("rgb",0,l(255)),green:s("rgb",1,l(255)),blue:s("rgb",2,l(255)),hue:s(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:s("hsl",1,l(100)),lightness:s("hsl",2,l(100)),saturationv:s("hsv",1,l(100)),value:s("hsv",2,l(100)),chroma:s("hcg",1,l(100)),gray:s("hcg",2,l(100)),white:s("hwb",1,l(100)),wblack:s("hwb",2,l(100)),cyan:s("cmyk",0,l(100)),magenta:s("cmyk",1,l(100)),yellow:s("cmyk",2,l(100)),black:s("cmyk",3,l(100)),x:s("xyz",0,l(95.047)),y:s("xyz",1,l(100)),z:s("xyz",2,l(108.833)),l:s("lab",0,l(100)),a:s("lab",1),b:s("lab",2),keyword(e){return void 0!==e?new o(e):t[this.model].keyword(this.color)},hex(t){return void 0!==t?new o(t):e.to.hex(this.rgb().round().color)},hexa(t){if(void 0!==t)return new o(t);const r=this.rgb().round().color;let i=Math.round(255*this.valpha).toString(16).toUpperCase();return 1===i.length&&(i="0"+i),e.to.hex(r)+i},rgbNumber(){const e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity(){const e=this.rgb().color,t=[];for(const[r,i]of e.entries()){const e=i/255;t[r]=e<=.04045?e/12.92:((e+.055)/1.055)**2.4}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){const t=this.luminosity(),r=e.luminosity();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},level(e){const t=this.contrast(e);return t>=7?"AAA":t>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(2126*e[0]+7152*e[1]+722*e[2])/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten(e){const t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken(e){const t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate(e){const t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate(e){const t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten(e){const t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken(e){const t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale(){const e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return o.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const t=this.hsl();let r=t.color[0];return r=(r+e)%360,r=r<0?360+r:r,t.color[0]=r,t},mix(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const r=e.rgb(),i=this.rgb(),n=void 0===t?.5:t,a=2*n-1,s=r.alpha()-i.alpha(),l=((a*s===-1?a:(a+s)/(1+a*s))+1)/2,h=1-l;return o.rgb(l*r.red()+h*i.red(),l*r.green()+h*i.green(),l*r.blue()+h*i.blue(),r.alpha()*n+i.alpha()*(1-n))}};for(const e of Object.keys(t)){if(r.includes(e))continue;const{channels:i}=t[e];o.prototype[e]=function(...r){return this.model===e?new o(this):r.length>0?new o(r,e):new o([...(i=t[this.model][e].raw(this.color),Array.isArray(i)?i:[i]),this.valpha],e);var i},o[e]=function(...t){let r=t[0];return"number"==typeof r&&(r=h(t,i)),new o(r,e)}}function a(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}function s(e,t,r){e=Array.isArray(e)?e:[e];for(const i of e)(n[i]||(n[i]=[]))[t]=r;return e=e[0],function(i){let n;return void 0!==i?(r&&(i=r(i)),n=this[e](),n.color[t]=i,n):(n=this[e]().color[t],r&&(n=r(n)),n)}}function l(e){return function(t){return Math.max(0,Math.min(e,t))}}function h(e,t){for(let r=0;r<t;r++)"number"!=typeof e[r]&&(e[r]=0);return e}return nt=o}var Pt=function(){if(gt)return dt;gt=1;const e=function(){if(Se)return ke;Se=1;const e=t,i=r,n=x();ze();const o=e.debuglog("sharp"),a=function(e,t){if(1===arguments.length&&!n.defined(e))throw new Error("Invalid input");return this instanceof a?(i.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBeforePreExtract:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tint:[-1,0,0,0],flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,precision:"integer",minAmpl:.2,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:-1,trimLineArt:!1,dilateWidth:0,erodeWidth:0,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:!0,resolveWithObject:!1,loop:-1,delay:[],jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpSmartDeblock:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffPredictor:"horizontal",tiffPyramid:!1,tiffMiniswhite:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],pdfBackground:[255,255,255,255],debuglog:e=>{this.emit("warning",e),o(e)},queueListener:function(e){a.queue.emit("change",e)}},this.options.input=this._createInputDescriptor(e,t,{allowStream:!0}),this):new a(e,t)};return Object.setPrototypeOf(a.prototype,i.Duplex.prototype),Object.setPrototypeOf(a,i.Duplex),Object.assign(a.prototype,{clone:function(){const e=this.constructor.call(),{debuglog:t,queueListener:r,...i}=this.options;return e.options=structuredClone(i),e.options.debuglog=t,e.options.queueListener=r,this._isStreamInput()&&this.on("finish",()=>{this._flattenBufferIn(),e.options.input.buffer=this.options.input.buffer,e.emit("finish")}),e}}),ke=a}();return function(){if(Ne)return Me;Ne=1;const e=x(),t=ze(),r={left:"low",top:"low",low:"low",center:"centre",centre:"centre",right:"high",bottom:"high",high:"high"};function i(t){const{raw:r,density:i,limitInputPixels:n,ignoreIcc:o,unlimited:a,sequentialRead:s,failOn:l,failOnError:h,animated:u,page:c,pages:f,subifd:p,pdfBackground:d,autoOrient:g}=t;return[r,i,n,o,a,s,l,h,u,c,f,p,d,g].some(e.defined)?{raw:r,density:i,limitInputPixels:n,ignoreIcc:o,unlimited:a,sequentialRead:s,failOn:l,failOnError:h,animated:u,page:c,pages:f,subifd:p,pdfBackground:d,autoOrient:g}:void 0}function n(t,r,n){const o={autoOrient:!1,failOn:"warning",limitInputPixels:Math.pow(16383,2),ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(e.string(t))o.file=t;else if(e.buffer(t)){if(0===t.length)throw Error("Input Buffer is empty");o.buffer=t}else if(e.arrayBuffer(t)){if(0===t.byteLength)throw Error("Input bit Array is empty");o.buffer=Buffer.from(t,0,t.byteLength)}else if(e.typedArray(t)){if(0===t.length)throw Error("Input Bit Array is empty");o.buffer=Buffer.from(t.buffer,t.byteOffset,t.byteLength)}else if(e.plainObject(t)&&!e.defined(r))i(r=t)&&(o.buffer=[]);else if(!e.defined(t)&&!e.defined(r)&&e.object(n)&&n.allowStream)o.buffer=[];else{if(!Array.isArray(t))throw new Error(`Unsupported input '${t}' of type ${typeof t}${e.defined(r)?" when also providing options of type "+typeof r:""}`);if(!(t.length>1))throw new Error("Expected at least two images to join");if(this.options.joining)throw new Error("Recursive join is unsupported");this.options.joining=!0,this.options.join=t.map(e=>this._createInputDescriptor(e))}if(e.object(r)){if(e.defined(r.failOnError)){if(!e.bool(r.failOnError))throw e.invalidParameterError("failOnError","boolean",r.failOnError);o.failOn=r.failOnError?"warning":"none"}if(e.defined(r.failOn)){if(!e.string(r.failOn)||!e.inArray(r.failOn,["none","truncated","error","warning"]))throw e.invalidParameterError("failOn","one of: none, truncated, error, warning",r.failOn);o.failOn=r.failOn}if(e.defined(r.autoOrient)){if(!e.bool(r.autoOrient))throw e.invalidParameterError("autoOrient","boolean",r.autoOrient);o.autoOrient=r.autoOrient}if(e.defined(r.density)){if(!e.inRange(r.density,1,1e5))throw e.invalidParameterError("density","number between 1 and 100000",r.density);o.density=r.density}if(e.defined(r.ignoreIcc)){if(!e.bool(r.ignoreIcc))throw e.invalidParameterError("ignoreIcc","boolean",r.ignoreIcc);o.ignoreIcc=r.ignoreIcc}if(e.defined(r.limitInputPixels))if(e.bool(r.limitInputPixels))o.limitInputPixels=r.limitInputPixels?Math.pow(16383,2):0;else{if(!e.integer(r.limitInputPixels)||!e.inRange(r.limitInputPixels,0,Number.MAX_SAFE_INTEGER))throw e.invalidParameterError("limitInputPixels","positive integer",r.limitInputPixels);o.limitInputPixels=r.limitInputPixels}if(e.defined(r.unlimited)){if(!e.bool(r.unlimited))throw e.invalidParameterError("unlimited","boolean",r.unlimited);o.unlimited=r.unlimited}if(e.defined(r.sequentialRead)){if(!e.bool(r.sequentialRead))throw e.invalidParameterError("sequentialRead","boolean",r.sequentialRead);o.sequentialRead=r.sequentialRead}if(e.defined(r.raw)){if(!(e.object(r.raw)&&e.integer(r.raw.width)&&r.raw.width>0&&e.integer(r.raw.height)&&r.raw.height>0&&e.integer(r.raw.channels)&&e.inRange(r.raw.channels,1,4)))throw new Error("Expected width, height and channels for raw pixel input");switch(o.rawWidth=r.raw.width,o.rawHeight=r.raw.height,o.rawChannels=r.raw.channels,o.rawPremultiplied=!!r.raw.premultiplied,t.constructor){case Uint8Array:case Uint8ClampedArray:o.rawDepth="uchar";break;case Int8Array:o.rawDepth="char";break;case Uint16Array:o.rawDepth="ushort";break;case Int16Array:o.rawDepth="short";break;case Uint32Array:o.rawDepth="uint";break;case Int32Array:o.rawDepth="int";break;case Float32Array:o.rawDepth="float";break;case Float64Array:o.rawDepth="double";break;default:o.rawDepth="uchar"}}if(e.defined(r.animated)){if(!e.bool(r.animated))throw e.invalidParameterError("animated","boolean",r.animated);o.pages=r.animated?-1:1}if(e.defined(r.pages)){if(!e.integer(r.pages)||!e.inRange(r.pages,-1,1e5))throw e.invalidParameterError("pages","integer between -1 and 100000",r.pages);o.pages=r.pages}if(e.defined(r.page)){if(!e.integer(r.page)||!e.inRange(r.page,0,1e5))throw e.invalidParameterError("page","integer between 0 and 100000",r.page);o.page=r.page}if(e.defined(r.level)){if(!e.integer(r.level)||!e.inRange(r.level,0,256))throw e.invalidParameterError("level","integer between 0 and 256",r.level);o.level=r.level}if(e.defined(r.subifd)){if(!e.integer(r.subifd)||!e.inRange(r.subifd,-1,1e5))throw e.invalidParameterError("subifd","integer between -1 and 100000",r.subifd);o.subifd=r.subifd}if(e.defined(r.pdfBackground)&&(o.pdfBackground=this._getBackgroundColourOption(r.pdfBackground)),e.defined(r.create)){if(!(e.object(r.create)&&e.integer(r.create.width)&&r.create.width>0&&e.integer(r.create.height)&&r.create.height>0&&e.integer(r.create.channels)))throw new Error("Expected valid width, height and channels to create a new input image");if(o.createWidth=r.create.width,o.createHeight=r.create.height,o.createChannels=r.create.channels,e.defined(r.create.noise)){if(!e.object(r.create.noise))throw new Error("Expected noise to be an object");if(!e.inArray(r.create.noise.type,["gaussian"]))throw new Error("Only gaussian noise is supported at the moment");if(!e.inRange(r.create.channels,1,4))throw e.invalidParameterError("create.channels","number between 1 and 4",r.create.channels);if(o.createNoiseType=r.create.noise.type,!e.number(r.create.noise.mean)||!e.inRange(r.create.noise.mean,0,1e4))throw e.invalidParameterError("create.noise.mean","number between 0 and 10000",r.create.noise.mean);if(o.createNoiseMean=r.create.noise.mean,!e.number(r.create.noise.sigma)||!e.inRange(r.create.noise.sigma,0,1e4))throw e.invalidParameterError("create.noise.sigma","number between 0 and 10000",r.create.noise.sigma);o.createNoiseSigma=r.create.noise.sigma}else{if(!e.defined(r.create.background))throw new Error("Expected valid noise or background to create a new input image");if(!e.inRange(r.create.channels,3,4))throw e.invalidParameterError("create.channels","number between 3 and 4",r.create.channels);o.createBackground=this._getBackgroundColourOption(r.create.background)}delete o.buffer}if(e.defined(r.text)){if(!e.object(r.text)||!e.string(r.text.text))throw new Error("Expected a valid string to create an image with text.");if(o.textValue=r.text.text,e.defined(r.text.height)&&e.defined(r.text.dpi))throw new Error("Expected only one of dpi or height");if(e.defined(r.text.font)){if(!e.string(r.text.font))throw e.invalidParameterError("text.font","string",r.text.font);o.textFont=r.text.font}if(e.defined(r.text.fontfile)){if(!e.string(r.text.fontfile))throw e.invalidParameterError("text.fontfile","string",r.text.fontfile);o.textFontfile=r.text.fontfile}if(e.defined(r.text.width)){if(!(e.integer(r.text.width)&&r.text.width>0))throw e.invalidParameterError("text.width","positive integer",r.text.width);o.textWidth=r.text.width}if(e.defined(r.text.height)){if(!(e.integer(r.text.height)&&r.text.height>0))throw e.invalidParameterError("text.height","positive integer",r.text.height);o.textHeight=r.text.height}if(e.defined(r.text.align)){if(!e.string(r.text.align)||!e.string(this.constructor.align[r.text.align]))throw e.invalidParameterError("text.align","valid alignment",r.text.align);o.textAlign=this.constructor.align[r.text.align]}if(e.defined(r.text.justify)){if(!e.bool(r.text.justify))throw e.invalidParameterError("text.justify","boolean",r.text.justify);o.textJustify=r.text.justify}if(e.defined(r.text.dpi)){if(!e.integer(r.text.dpi)||!e.inRange(r.text.dpi,1,1e6))throw e.invalidParameterError("text.dpi","integer between 1 and 1000000",r.text.dpi);o.textDpi=r.text.dpi}if(e.defined(r.text.rgba)){if(!e.bool(r.text.rgba))throw e.invalidParameterError("text.rgba","bool",r.text.rgba);o.textRgba=r.text.rgba}if(e.defined(r.text.spacing)){if(!e.integer(r.text.spacing)||!e.inRange(r.text.spacing,-1e6,1e6))throw e.invalidParameterError("text.spacing","integer between -1000000 and 1000000",r.text.spacing);o.textSpacing=r.text.spacing}if(e.defined(r.text.wrap)){if(!e.string(r.text.wrap)||!e.inArray(r.text.wrap,["word","char","word-char","none"]))throw e.invalidParameterError("text.wrap","one of: word, char, word-char, none",r.text.wrap);o.textWrap=r.text.wrap}delete o.buffer}if(e.defined(r.join)){if(!e.defined(this.options.join))throw new Error("Expected input to be an array of images to join");if(e.defined(r.join.animated)){if(!e.bool(r.join.animated))throw e.invalidParameterError("join.animated","boolean",r.join.animated);o.joinAnimated=r.join.animated}if(e.defined(r.join.across)){if(!e.integer(r.join.across)||!e.inRange(r.join.across,1,1e6))throw e.invalidParameterError("join.across","integer between 1 and 100000",r.join.across);o.joinAcross=r.join.across}if(e.defined(r.join.shim)){if(!e.integer(r.join.shim)||!e.inRange(r.join.shim,0,1e6))throw e.invalidParameterError("join.shim","integer between 0 and 100000",r.join.shim);o.joinShim=r.join.shim}if(e.defined(r.join.background)&&(o.joinBackground=this._getBackgroundColourOption(r.join.background)),e.defined(r.join.halign)){if(!e.string(r.join.halign)||!e.string(this.constructor.align[r.join.halign]))throw e.invalidParameterError("join.halign","valid alignment",r.join.halign);o.joinHalign=this.constructor.align[r.join.halign]}if(e.defined(r.join.valign)){if(!e.string(r.join.valign)||!e.string(this.constructor.align[r.join.valign]))throw e.invalidParameterError("join.valign","valid alignment",r.join.valign);o.joinValign=this.constructor.align[r.join.valign]}}}else if(e.defined(r))throw new Error("Invalid input options "+r);return o}function o(t,r,i){Array.isArray(this.options.input.buffer)?e.buffer(t)?(0===this.options.input.buffer.length&&this.on("finish",()=>{this.streamInFinished=!0}),this.options.input.buffer.push(t),i()):i(new Error("Non-Buffer data on Writable Stream")):i(new Error("Unexpected data on Writable Stream"))}function a(){this._isStreamInput()&&(this.options.input.buffer=Buffer.concat(this.options.input.buffer))}function s(){return Array.isArray(this.options.input.buffer)}function l(r){const i=Error();return e.fn(r)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),t.metadata(this.options,(t,n)=>{t?r(e.nativeError(t,i)):r(null,n)})}):t.metadata(this.options,(t,n)=>{t?r(e.nativeError(t,i)):r(null,n)}),this):this._isStreamInput()?new Promise((r,n)=>{const o=()=>{this._flattenBufferIn(),t.metadata(this.options,(t,o)=>{t?n(e.nativeError(t,i)):r(o)})};this.writableFinished?o():this.once("finish",o)}):new Promise((r,n)=>{t.metadata(this.options,(t,o)=>{t?n(e.nativeError(t,i)):r(o)})})}function h(r){const i=Error();return e.fn(r)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),t.stats(this.options,(t,n)=>{t?r(e.nativeError(t,i)):r(null,n)})}):t.stats(this.options,(t,n)=>{t?r(e.nativeError(t,i)):r(null,n)}),this):this._isStreamInput()?new Promise((r,n)=>{this.on("finish",function(){this._flattenBufferIn(),t.stats(this.options,(t,o)=>{t?n(e.nativeError(t,i)):r(o)})})}):new Promise((r,n)=>{t.stats(this.options,(t,o)=>{t?n(e.nativeError(t,i)):r(o)})})}return Me=function(e){Object.assign(e.prototype,{_inputOptionsFromObject:i,_createInputDescriptor:n,_write:o,_flattenBufferIn:a,_isStreamInput:s,metadata:l,stats:h}),e.align=r}}()(e),function(){if(Be)return Te;Be=1;const e=x(),t={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},r={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},i={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},n={entropy:16,attention:17},o={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3",mks2013:"mks2013",mks2021:"mks2021"},a={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},s={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function l(e){return e.angle%360!=0||!0===e.input.autoOrient||0!==e.rotationAngle}function h(e){return-1!==e.width||-1!==e.height}function u(i,a,u){if(h(this.options)&&this.options.debuglog("ignoring previous resize options"),-1!==this.options.widthPost&&this.options.debuglog("operation order will be: extract, resize, extract"),e.defined(i))if(e.object(i)&&!e.defined(u))u=i;else{if(!(e.integer(i)&&i>0))throw e.invalidParameterError("width","positive integer",i);this.options.width=i}else this.options.width=-1;if(e.defined(a)){if(!(e.integer(a)&&a>0))throw e.invalidParameterError("height","positive integer",a);this.options.height=a}else this.options.height=-1;if(e.object(u)){if(e.defined(u.width)){if(!(e.integer(u.width)&&u.width>0))throw e.invalidParameterError("width","positive integer",u.width);this.options.width=u.width}if(e.defined(u.height)){if(!(e.integer(u.height)&&u.height>0))throw e.invalidParameterError("height","positive integer",u.height);this.options.height=u.height}if(e.defined(u.fit)){const t=s[u.fit];if(!e.string(t))throw e.invalidParameterError("fit","valid fit",u.fit);this.options.canvas=t}if(e.defined(u.position)){const i=e.integer(u.position)?u.position:n[u.position]||r[u.position]||t[u.position];if(!e.integer(i)||!e.inRange(i,0,8)&&!e.inRange(i,16,17))throw e.invalidParameterError("position","valid position/gravity/strategy",u.position);this.options.position=i}if(this._setBackgroundColourOption("resizeBackground",u.background),e.defined(u.kernel)){if(!e.string(o[u.kernel]))throw e.invalidParameterError("kernel","valid kernel name",u.kernel);this.options.kernel=o[u.kernel]}e.defined(u.withoutEnlargement)&&this._setBooleanOption("withoutEnlargement",u.withoutEnlargement),e.defined(u.withoutReduction)&&this._setBooleanOption("withoutReduction",u.withoutReduction),e.defined(u.fastShrinkOnLoad)&&this._setBooleanOption("fastShrinkOnLoad",u.fastShrinkOnLoad)}return l(this.options)&&h(this.options)&&(this.options.rotateBeforePreExtract=!0),this}function c(t){if(e.integer(t)&&t>0)this.options.extendTop=t,this.options.extendBottom=t,this.options.extendLeft=t,this.options.extendRight=t;else{if(!e.object(t))throw e.invalidParameterError("extend","integer or object",t);if(e.defined(t.top)){if(!(e.integer(t.top)&&t.top>=0))throw e.invalidParameterError("top","positive integer",t.top);this.options.extendTop=t.top}if(e.defined(t.bottom)){if(!(e.integer(t.bottom)&&t.bottom>=0))throw e.invalidParameterError("bottom","positive integer",t.bottom);this.options.extendBottom=t.bottom}if(e.defined(t.left)){if(!(e.integer(t.left)&&t.left>=0))throw e.invalidParameterError("left","positive integer",t.left);this.options.extendLeft=t.left}if(e.defined(t.right)){if(!(e.integer(t.right)&&t.right>=0))throw e.invalidParameterError("right","positive integer",t.right);this.options.extendRight=t.right}if(this._setBackgroundColourOption("extendBackground",t.background),e.defined(t.extendWith)){if(!e.string(i[t.extendWith]))throw e.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",t.extendWith);this.options.extendWith=i[t.extendWith]}}return this}function f(t){const r=h(this.options)||-1!==this.options.widthPre?"Post":"Pre";return-1!==this.options[`width${r}`]&&this.options.debuglog("ignoring previous extract options"),["left","top","width","height"].forEach(function(i){const n=t[i];if(!(e.integer(n)&&n>=0))throw e.invalidParameterError(i,"integer",n);this.options[i+("left"===i||"top"===i?"Offset":"")+r]=n},this),l(this.options)&&!h(this.options)&&(-1!==this.options.widthPre&&-1!==this.options.widthPost||(this.options.rotateBeforePreExtract=!0)),this}function p(t){if(this.options.trimThreshold=10,e.defined(t)){if(!e.object(t))throw e.invalidParameterError("trim","object",t);if(e.defined(t.background)&&this._setBackgroundColourOption("trimBackground",t.background),e.defined(t.threshold)){if(!(e.number(t.threshold)&&t.threshold>=0))throw e.invalidParameterError("threshold","positive number",t.threshold);this.options.trimThreshold=t.threshold}e.defined(t.lineArt)&&this._setBooleanOption("trimLineArt",t.lineArt)}return l(this.options)&&(this.options.rotateBeforePreExtract=!0),this}return Te=function(e){Object.assign(e.prototype,{resize:u,extend:c,extract:f,trim:p}),e.gravity=t,e.strategy=n,e.kernel=o,e.fit=a,e.position=r}}()(e),function(){if(Ce)return _e;Ce=1;const e=x(),t={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function r(r){if(!Array.isArray(r))throw e.invalidParameterError("images to composite","array",r);return this.options.composite=r.map(r=>{if(!e.object(r))throw e.invalidParameterError("image to composite","object",r);const i=this._inputOptionsFromObject(r),n={input:this._createInputDescriptor(r.input,i,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(e.defined(r.blend)){if(!e.string(t[r.blend]))throw e.invalidParameterError("blend","valid blend name",r.blend);n.blend=t[r.blend]}if(e.defined(r.tile)){if(!e.bool(r.tile))throw e.invalidParameterError("tile","boolean",r.tile);n.tile=r.tile}if(e.defined(r.left)){if(!e.integer(r.left))throw e.invalidParameterError("left","integer",r.left);n.left=r.left}if(e.defined(r.top)){if(!e.integer(r.top))throw e.invalidParameterError("top","integer",r.top);n.top=r.top}if(e.defined(r.top)!==e.defined(r.left))throw new Error("Expected both left and top to be set");if(n.hasOffset=e.integer(r.top)&&e.integer(r.left),e.defined(r.gravity))if(e.integer(r.gravity)&&e.inRange(r.gravity,0,8))n.gravity=r.gravity;else{if(!e.string(r.gravity)||!e.integer(this.constructor.gravity[r.gravity]))throw e.invalidParameterError("gravity","valid gravity",r.gravity);n.gravity=this.constructor.gravity[r.gravity]}if(e.defined(r.premultiplied)){if(!e.bool(r.premultiplied))throw e.invalidParameterError("premultiplied","boolean",r.premultiplied);n.premultiplied=r.premultiplied}return n}),this}return _e=function(e){e.prototype.composite=r,e.blend=t}}()(e),function(){if(De)return Fe;De=1;const e=x(),t={integer:"integer",float:"float",approximate:"approximate"};function r(t,r){if(!e.defined(t))return this.autoOrient();if((this.options.angle||this.options.rotationAngle)&&(this.options.debuglog("ignoring previous rotate options"),this.options.angle=0,this.options.rotationAngle=0),!e.integer(t)||t%90){if(!e.number(t))throw e.invalidParameterError("angle","numeric",t);this.options.rotationAngle=t,e.object(r)&&r.background&&this._setBackgroundColourOption("rotationBackground",r.background)}else this.options.angle=t;return this}function i(){return this.options.input.autoOrient=!0,this}function n(t){return this.options.flip=!e.bool(t)||t,this}function o(t){return this.options.flop=!e.bool(t)||t,this}function a(t,r){const i=[].concat(...t);if(4!==i.length||!i.every(e.number))throw e.invalidParameterError("matrix","1x4 or 2x2 array",t);if(this.options.affineMatrix=i,e.defined(r)){if(!e.object(r))throw e.invalidParameterError("options","object",r);if(this._setBackgroundColourOption("affineBackground",r.background),e.defined(r.idx)){if(!e.number(r.idx))throw e.invalidParameterError("options.idx","number",r.idx);this.options.affineIdx=r.idx}if(e.defined(r.idy)){if(!e.number(r.idy))throw e.invalidParameterError("options.idy","number",r.idy);this.options.affineIdy=r.idy}if(e.defined(r.odx)){if(!e.number(r.odx))throw e.invalidParameterError("options.odx","number",r.odx);this.options.affineOdx=r.odx}if(e.defined(r.ody)){if(!e.number(r.ody))throw e.invalidParameterError("options.ody","number",r.ody);this.options.affineOdy=r.ody}if(e.defined(r.interpolator)){if(!e.inArray(r.interpolator,Object.values(this.constructor.interpolators)))throw e.invalidParameterError("options.interpolator","valid interpolator name",r.interpolator);this.options.affineInterpolator=r.interpolator}}return this}function s(t,r,i){if(e.defined(t))if(e.bool(t))this.options.sharpenSigma=t?-1:0;else if(e.number(t)&&e.inRange(t,.01,1e4)){if(this.options.sharpenSigma=t,e.defined(r)){if(!e.number(r)||!e.inRange(r,0,1e4))throw e.invalidParameterError("flat","number between 0 and 10000",r);this.options.sharpenM1=r}if(e.defined(i)){if(!e.number(i)||!e.inRange(i,0,1e4))throw e.invalidParameterError("jagged","number between 0 and 10000",i);this.options.sharpenM2=i}}else{if(!e.plainObject(t))throw e.invalidParameterError("sigma","number between 0.01 and 10000",t);if(!e.number(t.sigma)||!e.inRange(t.sigma,1e-6,10))throw e.invalidParameterError("options.sigma","number between 0.000001 and 10",t.sigma);if(this.options.sharpenSigma=t.sigma,e.defined(t.m1)){if(!e.number(t.m1)||!e.inRange(t.m1,0,1e6))throw e.invalidParameterError("options.m1","number between 0 and 1000000",t.m1);this.options.sharpenM1=t.m1}if(e.defined(t.m2)){if(!e.number(t.m2)||!e.inRange(t.m2,0,1e6))throw e.invalidParameterError("options.m2","number between 0 and 1000000",t.m2);this.options.sharpenM2=t.m2}if(e.defined(t.x1)){if(!e.number(t.x1)||!e.inRange(t.x1,0,1e6))throw e.invalidParameterError("options.x1","number between 0 and 1000000",t.x1);this.options.sharpenX1=t.x1}if(e.defined(t.y2)){if(!e.number(t.y2)||!e.inRange(t.y2,0,1e6))throw e.invalidParameterError("options.y2","number between 0 and 1000000",t.y2);this.options.sharpenY2=t.y2}if(e.defined(t.y3)){if(!e.number(t.y3)||!e.inRange(t.y3,0,1e6))throw e.invalidParameterError("options.y3","number between 0 and 1000000",t.y3);this.options.sharpenY3=t.y3}}else this.options.sharpenSigma=-1;return this}function l(t){if(e.defined(t)){if(!e.integer(t)||!e.inRange(t,1,1e3))throw e.invalidParameterError("size","integer between 1 and 1000",t);this.options.medianSize=t}else this.options.medianSize=3;return this}function h(r){let i;if(e.number(r))i=r;else if(e.plainObject(r)){if(!e.number(r.sigma))throw e.invalidParameterError("options.sigma","number between 0.3 and 1000",i);if(i=r.sigma,"precision"in r){if(!e.string(t[r.precision]))throw e.invalidParameterError("precision","one of: integer, float, approximate",r.precision);this.options.precision=t[r.precision]}if("minAmplitude"in r){if(!e.number(r.minAmplitude)||!e.inRange(r.minAmplitude,.001,1))throw e.invalidParameterError("minAmplitude","number between 0.001 and 1",r.minAmplitude);this.options.minAmpl=r.minAmplitude}}if(e.defined(r))if(e.bool(r))this.options.blurSigma=r?-1:0;else{if(!e.number(i)||!e.inRange(i,.3,1e3))throw e.invalidParameterError("sigma","number between 0.3 and 1000",i);this.options.blurSigma=i}else this.options.blurSigma=-1;return this}function u(t){if(e.defined(t)){if(!(e.integer(t)&&t>0))throw e.invalidParameterError("dilate","positive integer",u);this.options.dilateWidth=t}else this.options.dilateWidth=1;return this}function c(t){if(e.defined(t)){if(!(e.integer(t)&&t>0))throw e.invalidParameterError("erode","positive integer",c);this.options.erodeWidth=t}else this.options.erodeWidth=1;return this}function f(t){return this.options.flatten=!e.bool(t)||t,e.object(t)&&this._setBackgroundColourOption("flattenBackground",t.background),this}function p(){return this.options.unflatten=!0,this}function d(t,r){if(e.defined(t)){if(!e.number(t)||!e.inRange(t,1,3))throw e.invalidParameterError("gamma","number between 1.0 and 3.0",t);this.options.gamma=t}else this.options.gamma=2.2;if(e.defined(r)){if(!e.number(r)||!e.inRange(r,1,3))throw e.invalidParameterError("gammaOut","number between 1.0 and 3.0",r);this.options.gammaOut=r}else this.options.gammaOut=this.options.gamma;return this}function g(t){if(this.options.negate=!e.bool(t)||t,e.plainObject(t)&&"alpha"in t){if(!e.bool(t.alpha))throw e.invalidParameterError("alpha","should be boolean value",t.alpha);this.options.negateAlpha=t.alpha}return this}function m(t){if(e.plainObject(t)){if(e.defined(t.lower)){if(!e.number(t.lower)||!e.inRange(t.lower,0,99))throw e.invalidParameterError("lower","number between 0 and 99",t.lower);this.options.normaliseLower=t.lower}if(e.defined(t.upper)){if(!e.number(t.upper)||!e.inRange(t.upper,1,100))throw e.invalidParameterError("upper","number between 1 and 100",t.upper);this.options.normaliseUpper=t.upper}}if(this.options.normaliseLower>=this.options.normaliseUpper)throw e.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function b(e){return this.normalise(e)}function w(t){if(!e.plainObject(t))throw e.invalidParameterError("options","plain object",t);if(!(e.integer(t.width)&&t.width>0))throw e.invalidParameterError("width","integer greater than zero",t.width);if(this.options.claheWidth=t.width,!(e.integer(t.height)&&t.height>0))throw e.invalidParameterError("height","integer greater than zero",t.height);if(this.options.claheHeight=t.height,e.defined(t.maxSlope)){if(!e.integer(t.maxSlope)||!e.inRange(t.maxSlope,0,100))throw e.invalidParameterError("maxSlope","integer between 0 and 100",t.maxSlope);this.options.claheMaxSlope=t.maxSlope}return this}function v(t){if(!(e.object(t)&&Array.isArray(t.kernel)&&e.integer(t.width)&&e.integer(t.height)&&e.inRange(t.width,3,1001)&&e.inRange(t.height,3,1001)&&t.height*t.width===t.kernel.length))throw new Error("Invalid convolution kernel");return e.integer(t.scale)||(t.scale=t.kernel.reduce(function(e,t){return e+t},0)),t.scale<1&&(t.scale=1),e.integer(t.offset)||(t.offset=0),this.options.convKernel=t,this}function E(t,r){if(e.defined(t))if(e.bool(t))this.options.threshold=t?128:0;else{if(!e.integer(t)||!e.inRange(t,0,255))throw e.invalidParameterError("threshold","integer between 0 and 255",t);this.options.threshold=t}else this.options.threshold=128;return e.object(r)&&!0!==r.greyscale&&!0!==r.grayscale?this.options.thresholdGrayscale=!1:this.options.thresholdGrayscale=!0,this}function y(t,r,i){if(this.options.boolean=this._createInputDescriptor(t,i),!e.string(r)||!e.inArray(r,["and","or","eor"]))throw e.invalidParameterError("operator","one of: and, or, eor",r);return this.options.booleanOp=r,this}function P(t,r){if(!e.defined(t)&&e.number(r)?t=1:e.number(t)&&!e.defined(r)&&(r=0),e.defined(t))if(e.number(t))this.options.linearA=[t];else{if(!(Array.isArray(t)&&t.length&&t.every(e.number)))throw e.invalidParameterError("a","number or array of numbers",t);this.options.linearA=t}else this.options.linearA=[];if(e.defined(r))if(e.number(r))this.options.linearB=[r];else{if(!(Array.isArray(r)&&r.length&&r.every(e.number)))throw e.invalidParameterError("b","number or array of numbers",r);this.options.linearB=r}else this.options.linearB=[];if(this.options.linearA.length!==this.options.linearB.length)throw new Error("Expected a and b to be arrays of the same length");return this}function O(t){if(!Array.isArray(t))throw e.invalidParameterError("inputMatrix","array",t);if(3!==t.length&&4!==t.length)throw e.invalidParameterError("inputMatrix","3x3 or 4x4 array",t.length);const r=t.flat().map(Number);if(9!==r.length&&16!==r.length)throw e.invalidParameterError("inputMatrix","cardinality of 9 or 16",r.length);return this.options.recombMatrix=r,this}function R(t){if(!e.plainObject(t))throw e.invalidParameterError("options","plain object",t);if("brightness"in t){if(!(e.number(t.brightness)&&t.brightness>=0))throw e.invalidParameterError("brightness","number above zero",t.brightness);this.options.brightness=t.brightness}if("saturation"in t){if(!(e.number(t.saturation)&&t.saturation>=0))throw e.invalidParameterError("saturation","number above zero",t.saturation);this.options.saturation=t.saturation}if("hue"in t){if(!e.integer(t.hue))throw e.invalidParameterError("hue","number",t.hue);this.options.hue=t.hue%360}if("lightness"in t){if(!e.number(t.lightness))throw e.invalidParameterError("lightness","number",t.lightness);this.options.lightness=t.lightness}return this}return Fe=function(e){Object.assign(e.prototype,{autoOrient:i,rotate:r,flip:n,flop:o,affine:a,sharpen:s,erode:c,dilate:u,median:l,blur:h,flatten:f,unflatten:p,gamma:d,negate:g,normalise:m,normalize:b,clahe:w,convolve:v,threshold:E,boolean:y,linear:P,recomb:O,modulate:R})}}()(e),function(){if(st)return at;st=1;const e=xt(),t=x(),r={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function i(e){return this._setBackgroundColourOption("tint",e),this}function n(e){return this.options.greyscale=!t.bool(e)||e,this}function o(e){return this.greyscale(e)}function a(e){if(!t.string(e))throw t.invalidParameterError("colourspace","string",e);return this.options.colourspacePipeline=e,this}function s(e){return this.pipelineColourspace(e)}function l(e){if(!t.string(e))throw t.invalidParameterError("colourspace","string",e);return this.options.colourspace=e,this}function h(e){return this.toColourspace(e)}function u(r){if(t.object(r)||t.string(r)){const t=e(r);return[t.red(),t.green(),t.blue(),Math.round(255*t.alpha())]}throw t.invalidParameterError("background","object or string",r)}function c(e,r){t.defined(r)&&(this.options[e]=u(r))}return at=function(e){Object.assign(e.prototype,{tint:i,greyscale:n,grayscale:o,pipelineColourspace:a,pipelineColorspace:s,toColourspace:l,toColorspace:h,_getBackgroundColourOption:u,_setBackgroundColourOption:c}),e.colourspace=r,e.colorspace=r}}()(e),function(){if(ht)return lt;ht=1;const e=x(),t={and:"and",or:"or",eor:"eor"};function r(){return this.options.removeAlpha=!0,this}function i(t){if(e.defined(t)){if(!e.number(t)||!e.inRange(t,0,1))throw e.invalidParameterError("alpha","number between 0 and 1",t);this.options.ensureAlpha=t}else this.options.ensureAlpha=1;return this}function n(t){const r={red:0,green:1,blue:2,alpha:3};if(Object.keys(r).includes(t)&&(t=r[t]),!e.integer(t)||!e.inRange(t,0,4))throw e.invalidParameterError("channel","integer or one of: red, green, blue, alpha",t);return this.options.extractChannel=t,this}function o(e,t){return Array.isArray(e)?e.forEach(function(e){this.options.joinChannelIn.push(this._createInputDescriptor(e,t))},this):this.options.joinChannelIn.push(this._createInputDescriptor(e,t)),this}function a(t){if(!e.string(t)||!e.inArray(t,["and","or","eor"]))throw e.invalidParameterError("boolOp","one of: and, or, eor",t);return this.options.bandBoolOp=t,this}return lt=function(e){Object.assign(e.prototype,{removeAlpha:r,ensureAlpha:i,extractChannel:n,joinChannel:o,bandbool:a}),e.bool=t}}()(e),function(){if(ct)return ut;ct=1;const e=s,t=x(),r=ze(),i=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),n=/\.(jp[2x]|j2[kc])$/i,o=()=>new Error("JP2 output requires libvips with support for OpenJPEG"),a=e=>1<<31-Math.clz32(Math.ceil(Math.log2(e)));function l(r,i){let a;if(t.string(r)?t.string(this.options.input.file)&&e.resolve(this.options.input.file)===e.resolve(r)?a=new Error("Cannot use same file for input and output"):n.test(e.extname(r))&&!this.constructor.format.jp2k.output.file&&(a=o()):a=new Error("Missing output file path"),!a){this.options.fileOut=r;const e=Error();return this._pipeline(i,e)}return t.fn(i)?(i(a),this):Promise.reject(a)}function h(e,r){t.object(e)?this._setBooleanOption("resolveWithObject",e.resolveWithObject):this.options.resolveWithObject&&(this.options.resolveWithObject=!1),this.options.fileOut="";const i=Error();return this._pipeline(t.fn(e)?e:r,i)}function u(){return this.options.keepMetadata|=1,this}function c(e){if(!t.object(e))throw t.invalidParameterError("exif","object",e);for(const[r,i]of Object.entries(e)){if(!t.object(i))throw t.invalidParameterError(r,"object",i);for(const[e,n]of Object.entries(i)){if(!t.string(n))throw t.invalidParameterError(`${r}.${e}`,"string",n);this.options.withExif[`exif-${r.toLowerCase()}-${e}`]=n}}return this.options.withExifMerge=!1,this.keepExif()}function f(e){return this.withExif(e),this.options.withExifMerge=!0,this}function p(){return this.options.keepMetadata|=8,this}function d(e,r){if(!t.string(e))throw t.invalidParameterError("icc","string",e);if(this.options.withIccProfile=e,this.keepIccProfile(),t.object(r)&&t.defined(r.attach)){if(!t.bool(r.attach))throw t.invalidParameterError("attach","boolean",r.attach);r.attach||(this.options.keepMetadata&=-9)}return this}function g(){return this.options.keepMetadata=31,this}function m(e){if(this.keepMetadata(),this.withIccProfile("srgb"),t.object(e)){if(t.defined(e.orientation)){if(!t.integer(e.orientation)||!t.inRange(e.orientation,1,8))throw t.invalidParameterError("orientation","integer between 1 and 8",e.orientation);this.options.withMetadataOrientation=e.orientation}if(t.defined(e.density)){if(!(t.number(e.density)&&e.density>0))throw t.invalidParameterError("density","positive number",e.density);this.options.withMetadataDensity=e.density}t.defined(e.icc)&&this.withIccProfile(e.icc),t.defined(e.exif)&&this.withExifMerge(e.exif)}return this}function b(e,r){const n=i.get((t.object(e)&&t.string(e.id)?e.id:e).toLowerCase());if(!n)throw t.invalidParameterError("format",`one of: ${[...i.keys()].join(", ")}`,e);return this[n](r)}function w(e){if(t.object(e)){if(t.defined(e.quality)){if(!t.integer(e.quality)||!t.inRange(e.quality,1,100))throw t.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.jpegQuality=e.quality}if(t.defined(e.progressive)&&this._setBooleanOption("jpegProgressive",e.progressive),t.defined(e.chromaSubsampling)){if(!t.string(e.chromaSubsampling)||!t.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))throw t.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);this.options.jpegChromaSubsampling=e.chromaSubsampling}const r=t.bool(e.optimizeCoding)?e.optimizeCoding:e.optimiseCoding;if(t.defined(r)&&this._setBooleanOption("jpegOptimiseCoding",r),t.defined(e.mozjpeg)){if(!t.bool(e.mozjpeg))throw t.invalidParameterError("mozjpeg","boolean",e.mozjpeg);e.mozjpeg&&(this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3)}const i=t.bool(e.trellisQuantization)?e.trellisQuantization:e.trellisQuantisation;t.defined(i)&&this._setBooleanOption("jpegTrellisQuantisation",i),t.defined(e.overshootDeringing)&&this._setBooleanOption("jpegOvershootDeringing",e.overshootDeringing);const n=t.bool(e.optimizeScans)?e.optimizeScans:e.optimiseScans;t.defined(n)&&(this._setBooleanOption("jpegOptimiseScans",n),n&&(this.options.jpegProgressive=!0));const o=t.number(e.quantizationTable)?e.quantizationTable:e.quantisationTable;if(t.defined(o)){if(!t.integer(o)||!t.inRange(o,0,8))throw t.invalidParameterError("quantisationTable","integer between 0 and 8",o);this.options.jpegQuantisationTable=o}}return this._updateFormatOut("jpeg",e)}function v(e){if(t.object(e)){if(t.defined(e.progressive)&&this._setBooleanOption("pngProgressive",e.progressive),t.defined(e.compressionLevel)){if(!t.integer(e.compressionLevel)||!t.inRange(e.compressionLevel,0,9))throw t.invalidParameterError("compressionLevel","integer between 0 and 9",e.compressionLevel);this.options.pngCompressionLevel=e.compressionLevel}t.defined(e.adaptiveFiltering)&&this._setBooleanOption("pngAdaptiveFiltering",e.adaptiveFiltering);const r=e.colours||e.colors;if(t.defined(r)){if(!t.integer(r)||!t.inRange(r,2,256))throw t.invalidParameterError("colours","integer between 2 and 256",r);this.options.pngBitdepth=a(r)}if(t.defined(e.palette)?this._setBooleanOption("pngPalette",e.palette):[e.quality,e.effort,e.colours,e.colors,e.dither].some(t.defined)&&this._setBooleanOption("pngPalette",!0),this.options.pngPalette){if(t.defined(e.quality)){if(!t.integer(e.quality)||!t.inRange(e.quality,0,100))throw t.invalidParameterError("quality","integer between 0 and 100",e.quality);this.options.pngQuality=e.quality}if(t.defined(e.effort)){if(!t.integer(e.effort)||!t.inRange(e.effort,1,10))throw t.invalidParameterError("effort","integer between 1 and 10",e.effort);this.options.pngEffort=e.effort}if(t.defined(e.dither)){if(!t.number(e.dither)||!t.inRange(e.dither,0,1))throw t.invalidParameterError("dither","number between 0.0 and 1.0",e.dither);this.options.pngDither=e.dither}}}return this._updateFormatOut("png",e)}function E(e){if(t.object(e)){if(t.defined(e.quality)){if(!t.integer(e.quality)||!t.inRange(e.quality,1,100))throw t.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.webpQuality=e.quality}if(t.defined(e.alphaQuality)){if(!t.integer(e.alphaQuality)||!t.inRange(e.alphaQuality,0,100))throw t.invalidParameterError("alphaQuality","integer between 0 and 100",e.alphaQuality);this.options.webpAlphaQuality=e.alphaQuality}if(t.defined(e.lossless)&&this._setBooleanOption("webpLossless",e.lossless),t.defined(e.nearLossless)&&this._setBooleanOption("webpNearLossless",e.nearLossless),t.defined(e.smartSubsample)&&this._setBooleanOption("webpSmartSubsample",e.smartSubsample),t.defined(e.smartDeblock)&&this._setBooleanOption("webpSmartDeblock",e.smartDeblock),t.defined(e.preset)){if(!t.string(e.preset)||!t.inArray(e.preset,["default","photo","picture","drawing","icon","text"]))throw t.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",e.preset);this.options.webpPreset=e.preset}if(t.defined(e.effort)){if(!t.integer(e.effort)||!t.inRange(e.effort,0,6))throw t.invalidParameterError("effort","integer between 0 and 6",e.effort);this.options.webpEffort=e.effort}t.defined(e.minSize)&&this._setBooleanOption("webpMinSize",e.minSize),t.defined(e.mixed)&&this._setBooleanOption("webpMixed",e.mixed)}return O(e,this.options),this._updateFormatOut("webp",e)}function y(e){if(t.object(e)){t.defined(e.reuse)&&this._setBooleanOption("gifReuse",e.reuse),t.defined(e.progressive)&&this._setBooleanOption("gifProgressive",e.progressive);const r=e.colours||e.colors;if(t.defined(r)){if(!t.integer(r)||!t.inRange(r,2,256))throw t.invalidParameterError("colours","integer between 2 and 256",r);this.options.gifBitdepth=a(r)}if(t.defined(e.effort)){if(!t.number(e.effort)||!t.inRange(e.effort,1,10))throw t.invalidParameterError("effort","integer between 1 and 10",e.effort);this.options.gifEffort=e.effort}if(t.defined(e.dither)){if(!t.number(e.dither)||!t.inRange(e.dither,0,1))throw t.invalidParameterError("dither","number between 0.0 and 1.0",e.dither);this.options.gifDither=e.dither}if(t.defined(e.interFrameMaxError)){if(!t.number(e.interFrameMaxError)||!t.inRange(e.interFrameMaxError,0,32))throw t.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",e.interFrameMaxError);this.options.gifInterFrameMaxError=e.interFrameMaxError}if(t.defined(e.interPaletteMaxError)){if(!t.number(e.interPaletteMaxError)||!t.inRange(e.interPaletteMaxError,0,256))throw t.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",e.interPaletteMaxError);this.options.gifInterPaletteMaxError=e.interPaletteMaxError}}return O(e,this.options),this._updateFormatOut("gif",e)}function P(e){if(!this.constructor.format.jp2k.output.buffer)throw o();if(t.object(e)){if(t.defined(e.quality)){if(!t.integer(e.quality)||!t.inRange(e.quality,1,100))throw t.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.jp2Quality=e.quality}if(t.defined(e.lossless)){if(!t.bool(e.lossless))throw t.invalidParameterError("lossless","boolean",e.lossless);this.options.jp2Lossless=e.lossless}if(t.defined(e.tileWidth)){if(!t.integer(e.tileWidth)||!t.inRange(e.tileWidth,1,32768))throw t.invalidParameterError("tileWidth","integer between 1 and 32768",e.tileWidth);this.options.jp2TileWidth=e.tileWidth}if(t.defined(e.tileHeight)){if(!t.integer(e.tileHeight)||!t.inRange(e.tileHeight,1,32768))throw t.invalidParameterError("tileHeight","integer between 1 and 32768",e.tileHeight);this.options.jp2TileHeight=e.tileHeight}if(t.defined(e.chromaSubsampling)){if(!t.string(e.chromaSubsampling)||!t.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))throw t.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);this.options.jp2ChromaSubsampling=e.chromaSubsampling}}return this._updateFormatOut("jp2",e)}function O(e,r){if(t.object(e)&&t.defined(e.loop)){if(!t.integer(e.loop)||!t.inRange(e.loop,0,65535))throw t.invalidParameterError("loop","integer between 0 and 65535",e.loop);r.loop=e.loop}if(t.object(e)&&t.defined(e.delay))if(t.integer(e.delay)&&t.inRange(e.delay,0,65535))r.delay=[e.delay];else{if(!(Array.isArray(e.delay)&&e.delay.every(t.integer)&&e.delay.every(e=>t.inRange(e,0,65535))))throw t.invalidParameterError("delay","integer or an array of integers between 0 and 65535",e.delay);r.delay=e.delay}}function R(e){if(t.object(e)){if(t.defined(e.quality)){if(!t.integer(e.quality)||!t.inRange(e.quality,1,100))throw t.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.tiffQuality=e.quality}if(t.defined(e.bitdepth)){if(!t.integer(e.bitdepth)||!t.inArray(e.bitdepth,[1,2,4,8]))throw t.invalidParameterError("bitdepth","1, 2, 4 or 8",e.bitdepth);this.options.tiffBitdepth=e.bitdepth}if(t.defined(e.tile)&&this._setBooleanOption("tiffTile",e.tile),t.defined(e.tileWidth)){if(!(t.integer(e.tileWidth)&&e.tileWidth>0))throw t.invalidParameterError("tileWidth","integer greater than zero",e.tileWidth);this.options.tiffTileWidth=e.tileWidth}if(t.defined(e.tileHeight)){if(!(t.integer(e.tileHeight)&&e.tileHeight>0))throw t.invalidParameterError("tileHeight","integer greater than zero",e.tileHeight);this.options.tiffTileHeight=e.tileHeight}if(t.defined(e.miniswhite)&&this._setBooleanOption("tiffMiniswhite",e.miniswhite),t.defined(e.pyramid)&&this._setBooleanOption("tiffPyramid",e.pyramid),t.defined(e.xres)){if(!(t.number(e.xres)&&e.xres>0))throw t.invalidParameterError("xres","number greater than zero",e.xres);this.options.tiffXres=e.xres}if(t.defined(e.yres)){if(!(t.number(e.yres)&&e.yres>0))throw t.invalidParameterError("yres","number greater than zero",e.yres);this.options.tiffYres=e.yres}if(t.defined(e.compression)){if(!t.string(e.compression)||!t.inArray(e.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))throw t.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",e.compression);this.options.tiffCompression=e.compression}if(t.defined(e.predictor)){if(!t.string(e.predictor)||!t.inArray(e.predictor,["none","horizontal","float"]))throw t.invalidParameterError("predictor","one of: none, horizontal, float",e.predictor);this.options.tiffPredictor=e.predictor}if(t.defined(e.resolutionUnit)){if(!t.string(e.resolutionUnit)||!t.inArray(e.resolutionUnit,["inch","cm"]))throw t.invalidParameterError("resolutionUnit","one of: inch, cm",e.resolutionUnit);this.options.tiffResolutionUnit=e.resolutionUnit}}return this._updateFormatOut("tiff",e)}function j(e){return this.heif({...e,compression:"av1"})}function I(e){if(!t.object(e))throw t.invalidParameterError("options","Object",e);if(!t.string(e.compression)||!t.inArray(e.compression,["av1","hevc"]))throw t.invalidParameterError("compression","one of: av1, hevc",e.compression);if(this.options.heifCompression=e.compression,t.defined(e.quality)){if(!t.integer(e.quality)||!t.inRange(e.quality,1,100))throw t.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.heifQuality=e.quality}if(t.defined(e.lossless)){if(!t.bool(e.lossless))throw t.invalidParameterError("lossless","boolean",e.lossless);this.options.heifLossless=e.lossless}if(t.defined(e.effort)){if(!t.integer(e.effort)||!t.inRange(e.effort,0,9))throw t.invalidParameterError("effort","integer between 0 and 9",e.effort);this.options.heifEffort=e.effort}if(t.defined(e.chromaSubsampling)){if(!t.string(e.chromaSubsampling)||!t.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))throw t.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);this.options.heifChromaSubsampling=e.chromaSubsampling}if(t.defined(e.bitdepth)){if(!t.integer(e.bitdepth)||!t.inArray(e.bitdepth,[8,10,12]))throw t.invalidParameterError("bitdepth","8, 10 or 12",e.bitdepth);if(8!==e.bitdepth&&this.constructor.versions.heif)throw t.invalidParameterError("bitdepth when using prebuilt binaries",8,e.bitdepth);this.options.heifBitdepth=e.bitdepth}return this._updateFormatOut("heif",e)}function $(e){if(t.object(e)){if(t.defined(e.quality)){if(!t.integer(e.quality)||!t.inRange(e.quality,1,100))throw t.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.jxlDistance=e.quality>=30?.1+.09*(100-e.quality):53/3e3*e.quality*e.quality-1.15*e.quality+25}else if(t.defined(e.distance)){if(!t.number(e.distance)||!t.inRange(e.distance,0,15))throw t.invalidParameterError("distance","number between 0.0 and 15.0",e.distance);this.options.jxlDistance=e.distance}if(t.defined(e.decodingTier)){if(!t.integer(e.decodingTier)||!t.inRange(e.decodingTier,0,4))throw t.invalidParameterError("decodingTier","integer between 0 and 4",e.decodingTier);this.options.jxlDecodingTier=e.decodingTier}if(t.defined(e.lossless)){if(!t.bool(e.lossless))throw t.invalidParameterError("lossless","boolean",e.lossless);this.options.jxlLossless=e.lossless}if(t.defined(e.effort)){if(!t.integer(e.effort)||!t.inRange(e.effort,1,9))throw t.invalidParameterError("effort","integer between 1 and 9",e.effort);this.options.jxlEffort=e.effort}}return O(e,this.options),this._updateFormatOut("jxl",e)}function A(e){if(t.object(e)&&t.defined(e.depth)){if(!t.string(e.depth)||!t.inArray(e.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))throw t.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",e.depth);this.options.rawDepth=e.depth}return this._updateFormatOut("raw")}function L(e){if(t.object(e)){if(t.defined(e.size)){if(!t.integer(e.size)||!t.inRange(e.size,1,8192))throw t.invalidParameterError("size","integer between 1 and 8192",e.size);this.options.tileSize=e.size}if(t.defined(e.overlap)){if(!t.integer(e.overlap)||!t.inRange(e.overlap,0,8192))throw t.invalidParameterError("overlap","integer between 0 and 8192",e.overlap);if(e.overlap>this.options.tileSize)throw t.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,e.overlap);this.options.tileOverlap=e.overlap}if(t.defined(e.container)){if(!t.string(e.container)||!t.inArray(e.container,["fs","zip"]))throw t.invalidParameterError("container","one of: fs, zip",e.container);this.options.tileContainer=e.container}if(t.defined(e.layout)){if(!t.string(e.layout)||!t.inArray(e.layout,["dz","google","iiif","iiif3","zoomify"]))throw t.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",e.layout);this.options.tileLayout=e.layout}if(t.defined(e.angle)){if(!t.integer(e.angle)||e.angle%90)throw t.invalidParameterError("angle","positive/negative multiple of 90",e.angle);this.options.tileAngle=e.angle}if(this._setBackgroundColourOption("tileBackground",e.background),t.defined(e.depth)){if(!t.string(e.depth)||!t.inArray(e.depth,["onepixel","onetile","one"]))throw t.invalidParameterError("depth","one of: onepixel, onetile, one",e.depth);this.options.tileDepth=e.depth}if(t.defined(e.skipBlanks)){if(!t.integer(e.skipBlanks)||!t.inRange(e.skipBlanks,-1,65535))throw t.invalidParameterError("skipBlanks","integer between -1 and 255/65535",e.skipBlanks);this.options.tileSkipBlanks=e.skipBlanks}else t.defined(e.layout)&&"google"===e.layout&&(this.options.tileSkipBlanks=5);const r=t.bool(e.center)?e.center:e.centre;if(t.defined(r)&&this._setBooleanOption("tileCentre",r),t.defined(e.id)){if(!t.string(e.id))throw t.invalidParameterError("id","string",e.id);this.options.tileId=e.id}if(t.defined(e.basename)){if(!t.string(e.basename))throw t.invalidParameterError("basename","string",e.basename);this.options.tileBasename=e.basename}}if(t.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if("input"!==this.options.formatOut)throw t.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function k(e){if(!t.plainObject(e))throw t.invalidParameterError("options","object",e);if(!t.integer(e.seconds)||!t.inRange(e.seconds,0,3600))throw t.invalidParameterError("seconds","integer between 0 and 3600",e.seconds);return this.options.timeoutSeconds=e.seconds,this}function S(e,r){return t.object(r)&&!1===r.force||(this.options.formatOut=e),this}function M(e,r){if(!t.bool(r))throw t.invalidParameterError(e,"boolean",r);this.options[e]=r}function N(){if(!this.options.streamOut){this.options.streamOut=!0;const e=Error();this._pipeline(void 0,e)}}function T(e,i){return"function"==typeof e?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),r.pipeline(this.options,(r,n,o)=>{r?e(t.nativeError(r,i)):e(null,n,o)})}):r.pipeline(this.options,(r,n,o)=>{r?e(t.nativeError(r,i)):e(null,n,o)}),this):this.options.streamOut?(this._isStreamInput()?(this.once("finish",()=>{this._flattenBufferIn(),r.pipeline(this.options,(e,r,n)=>{e?this.emit("error",t.nativeError(e,i)):(this.emit("info",n),this.push(r)),this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished&&this.emit("finish")):r.pipeline(this.options,(e,r,n)=>{e?this.emit("error",t.nativeError(e,i)):(this.emit("info",n),this.push(r)),this.push(null),this.on("end",()=>this.emit("close"))}),this):this._isStreamInput()?new Promise((e,n)=>{this.once("finish",()=>{this._flattenBufferIn(),r.pipeline(this.options,(r,o,a)=>{r?n(t.nativeError(r,i)):this.options.resolveWithObject?e({data:o,info:a}):e(o)})})}):new Promise((e,n)=>{r.pipeline(this.options,(r,o,a)=>{r?n(t.nativeError(r,i)):this.options.resolveWithObject?e({data:o,info:a}):e(o)})})}return ut=function(e){Object.assign(e.prototype,{toFile:l,toBuffer:h,keepExif:u,withExif:c,withExifMerge:f,keepIccProfile:p,withIccProfile:d,keepMetadata:g,withMetadata:m,toFormat:b,jpeg:w,jp2:P,png:v,webp:E,tiff:R,avif:j,heif:I,jxl:$,gif:y,raw:A,tile:L,timeout:k,_updateFormatOut:S,_setBooleanOption:M,_read:N,_pipeline:T})}}()(e),function(){if(pt)return ft;pt=1;const e=l,t=T(),r=x(),{runtimePlatformArch:i}=Ue(),n=ze(),o=i(),a=n.libvipsVersion(),s=n.format();s.heif.output.alias=["avif","heic"],s.jpeg.output.alias=["jpe","jpg"],s.tiff.output.alias=["tif"],s.jp2k.output.alias=["j2c","j2k","jp2","jpx"];const u={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"};let c={vips:a.semver};if(!a.isGlobal)if(a.isWasm)try{c=require("@img/sharp-wasm32/versions")}catch(e){}else try{c=P(`@img/sharp-${o}/versions`)}catch(e){try{c=P(`@img/sharp-libvips-${o}/versions`)}catch(e){}}function f(e){return r.bool(e)?e?n.cache(50,20,100):n.cache(0,0,0):r.object(e)?n.cache(e.memory,e.files,e.items):n.cache()}function p(e){return n.concurrency(r.integer(e)?e:null)}c.sharp=qe.version,c.heif&&s.heif&&(s.heif.input.fileSuffix=[".avif"],s.heif.output.alias=["avif"]),f(!0),t.familySync()!==t.GLIBC||n._isUsingJemalloc()?t.familySync()===t.MUSL&&1024===n.concurrency()&&n.concurrency(h.availableParallelism()):n.concurrency(1);const d=new e.EventEmitter;function g(){return n.counters()}function m(e){return n.simd(r.bool(e)?e:null)}function b(e){if(!r.object(e))throw r.invalidParameterError("options","object",e);if(!Array.isArray(e.operation)||!e.operation.every(r.string))throw r.invalidParameterError("operation","Array<string>",e.operation);n.block(e.operation,!0)}function w(e){if(!r.object(e))throw r.invalidParameterError("options","object",e);if(!Array.isArray(e.operation)||!e.operation.every(r.string))throw r.invalidParameterError("operation","Array<string>",e.operation);n.block(e.operation,!1)}return ft=function(e){e.cache=f,e.concurrency=p,e.counters=g,e.simd=m,e.format=s,e.interpolators=u,e.versions=c,e.queue=d,e.block=b,e.unblock=w}}()(e),dt=e}(),Ot=v(Pt);function Rt(e){return new Promise(function(t,r){var i=new FileReader;i.onload=function(){"string"==typeof i.result?t(i.result):r(new Error("FileReader结果不是字符串"))},i.onerror=function(){return r(new Error("Blob转DataURL失败"))},i.readAsDataURL(e)})}function jt(e){return new Promise(function(t,r){var i=new Image;i.onload=function(){return t(i)},i.onerror=function(){return r(new Error("DataURL转图片失败"))},i.src=e})}function It(e){for(var t,r=e.split(","),i=(null===(t=r[0].match(/:(.*?);/))||void 0===t?void 0:t[1])||"image/jpeg",n=atob(r[1]),o=n.length,a=new Uint8Array(o);o--;)a[o]=n.charCodeAt(o);return new Blob([a],{type:i})}function $t(e,t){var r=It(e),i=r.type||"application/octet-stream",n=p(i);return t?!t.includes(".")&&n&&(t="".concat(t,".").concat(n)):t=g(n),new File([r],t,{type:i})}function At(e){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Rt(e)];case 1:return[4,jt(t.sent())];case 2:return[2,t.sent()]}})})}e.base64ToBlob=w,e.base64ToFile=function(e,t){var r=w(e),i=r.type||"application/octet-stream",n=p(i);return t?!t.includes(".")&&n&&(t="".concat(t,".").concat(n)):t=g(n),new File([r],t,{type:i})},e.blobToBase64=b,e.blobToDataURL=Rt,e.blobToFile=function(e,t){var r=e.type||"application/octet-stream",i=p(r);return t?!t.includes(".")&&i&&(t="".concat(t,".").concat(i)):t=g(i),new File([e],t,{type:r})},e.checkFileType=function(e){var t="",r="";return"string"==typeof e?t=d(r=f(e)):(t=e.type||"",r=e.name?f(e.name):p(t)),{isImage:t.startsWith("image/"),isAudio:t.startsWith("audio/"),isVideo:t.startsWith("video/"),mimeType:t,extension:r}},e.convertImageFormat=function(e,t){return u(this,void 0,void 0,function(){var r;return c(this,function(i){switch(i.label){case 0:switch(r=Ot(e),t){case"jpeg":case"jpg":r=r.jpeg();break;case"png":r=r.png();break;case"heic":r=r.heif({compression:"hevc"});break;default:throw new Error("不支持的目标图片格式: "+t)}return[4,r.toBuffer()];case 1:return[2,i.sent()]}})})},e.dataURLToImage=jt,e.dataURLtoBlob=It,e.dataURLtoFile=$t,e.dataURLtoImgBlob=function(e){var t=It(e);if(!t.type.startsWith("image/"))throw new Error("提供的DataURL不是图片格式");return t},e.delay=function(e){return new Promise(function(t){return setTimeout(t,e)})},e.fileToBase64=function(e){return b(e)},e.fileToBlob=function(e){return new Blob([e],{type:e.type})},e.generateRandomFileName=g,e.getBase64FromDataURL=function(e){return e.split(",")[1]||""},e.getExtensionFromMimeType=p,e.getFileExtension=f,e.getMimeTypeFromDataURL=m,e.getMimeTypeFromExtension=d,e.imageToDataURL=function(e,t,r){void 0===t&&(t="jpeg"),void 0===r&&(r=.9);var i=document.createElement("canvas");i.width=e.naturalWidth||e.width,i.height=e.naturalHeight||e.height;var n=i.getContext("2d");if(!n)throw new Error("无法创建canvas 2d上下文");return n.drawImage(e,0,0),i.toDataURL("image/".concat(t),r)},e.imgCompress=function(e){return u(this,arguments,void 0,function(e,t){var r,i,n,o,a,s,l,h,u,f,p,g,m,b;return void 0===t&&(t={}),c(this,function(c){switch(c.label){case 0:if(!e.type.startsWith("image/"))throw new Error("提供的文件不是图片格式");return r=t.quality,i=void 0===r?.8:r,n=t.maxWidth,o=t.maxHeight,a=t.format,s=e.type,a&&(s=d(a)),[4,At(e)];case 1:if(l=c.sent(),h=l.naturalWidth,u=l.naturalHeight,n&&h>n&&(u=u*n/h,h=n),o&&u>o&&(h=h*o/u,u=o),(f=document.createElement("canvas")).width=h,f.height=u,!(p=f.getContext("2d")))throw new Error("无法创建canvas 2d上下文");return p.drawImage(l,0,0,h,u),g=f.toDataURL(s,i),m=e.name,a&&(-1!==(b=m.lastIndexOf("."))&&(m=m.substring(0,b)),m="".concat(m,".").concat(a)),[2,$t(g,m)]}})})},e.imgConvert=function(e,t){return u(this,void 0,void 0,function(){var r,i,n,o,a,s,l,h,u,f;return c(this,function(c){switch(c.label){case 0:if(!e.type.startsWith("image/"))throw new Error("提供的文件不是图片格式");if(r=t.format,i=t.quality,n=void 0===i?.9:i,!(o=d(r)))throw new Error("不支持的图片格式: ".concat(r));return[4,At(e)];case 1:if(a=c.sent(),(s=document.createElement("canvas")).width=a.naturalWidth,s.height=a.naturalHeight,!(l=s.getContext("2d")))throw new Error("无法创建canvas 2d上下文");return l.drawImage(a,0,0),h=s.toDataURL(o,n),u=e.name,-1!==(f=u.lastIndexOf("."))&&(u=u.substring(0,f)),u="".concat(u,".").concat(r),[2,$t(h,u)]}})})},e.isBase64=function(e){if(!e||"string"!=typeof e)return!1;if(0===e.indexOf("data:"))return-1!==e.indexOf("base64");try{return btoa(atob(e))===e}catch(e){return!1}},e.isBlob=function(e){return e instanceof Blob},e.isFile=function(e){return e instanceof File},e.urlToBase64=function(e){return u(this,void 0,void 0,function(){var t;return c(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,fetch(e)];case 1:return[4,r.sent().blob()];case 2:return[4,b(r.sent())];case 3:return[2,r.sent()];case 4:throw t=r.sent(),new Error("URL转Base64失败: ".concat(t instanceof Error?t.message:String(t)));case 5:return[2]}})})}});
//# sourceMappingURL=index.umd.js.map
