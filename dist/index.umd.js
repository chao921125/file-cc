!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).FileCC={})}(this,function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function e(t,e,n,r){return new(n||(n=Promise))(function(a,o){function i(t){try{u(r.next(t))}catch(t){o(t)}}function c(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,c)}u((r=r.apply(t,e||[])).next())})}function n(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}function r(t){var e;if(!t)return"";var n=t.split(".");return n.length>1&&(null===(e=n.pop())||void 0===e?void 0:e.toLowerCase())||""}function a(t){return{"image/jpeg":"jpg","image/jpg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","image/bmp":"bmp","audio/mpeg":"mp3","audio/mp3":"mp3","audio/wav":"wav","audio/ogg":"ogg","video/mp4":"mp4","video/webm":"webm","video/ogg":"ogv","application/pdf":"pdf","text/plain":"txt","text/html":"html","text/css":"css","text/javascript":"js","application/json":"json"}[t]||""}function o(t){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",mp3:"audio/mpeg",wav:"audio/wav",ogg:"audio/ogg",mp4:"video/mp4",webm:"video/webm",ogv:"video/ogg",pdf:"application/pdf",txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json"}[t.toLowerCase()]||"application/octet-stream"}function i(t){void 0===t&&(t="");var e=(new Date).getTime(),n=Math.floor(1e4*Math.random());return"file_".concat(e,"_").concat(n).concat(t?"."+t:"")}function c(t){var e=t.match(/^data:([\w\/+]+);base64,/);return e&&e.length>1?e[1]:""}function u(t){return new Promise(function(e,n){var r=new FileReader;r.onload=function(){"string"==typeof r.result?e(r.result):n(new Error("FileReader结果不是字符串"))},r.onerror=function(){return n(new Error("Blob转Base64失败"))},r.readAsDataURL(t)})}function s(t){var e="application/octet-stream",n=t;t.startsWith("data:")&&(e=c(t)||e,n=t.split(",")[1]);for(var r=atob(n),a=[],o=0;o<r.length;o+=512){for(var i=r.slice(o,o+512),u=new Array(i.length),s=0;s<i.length;s++)u[s]=i.charCodeAt(s);var l=new Uint8Array(u);a.push(l)}return new Blob(a,{type:e})}function l(t){return new Promise(function(e,n){var r=new FileReader;r.onload=function(){"string"==typeof r.result?e(r.result):n(new Error("FileReader结果不是字符串"))},r.onerror=function(){return n(new Error("Blob转DataURL失败"))},r.readAsDataURL(t)})}function f(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){return e(r)},r.onerror=function(){return n(new Error("DataURL转图片失败"))},r.src=t})}function p(t){for(var e,n=t.split(","),r=(null===(e=n[0].match(/:(.*?);/))||void 0===e?void 0:e[1])||"image/jpeg",a=atob(n[1]),o=a.length,i=new Uint8Array(o);o--;)i[o]=a.charCodeAt(o);return new Blob([i],{type:r})}function d(t,e){var n=p(t),r=n.type||"application/octet-stream",o=a(r);return e?!e.includes(".")&&o&&(e="".concat(e,".").concat(o)):e=i(o),new File([n],e,{type:r})}function g(t){return e(this,void 0,void 0,function(){return n(this,function(e){switch(e.label){case 0:return[4,l(t)];case 1:return[4,f(e.sent())];case 2:return[2,e.sent()]}})})}t.base64ToBlob=s,t.base64ToFile=function(t,e){var n=s(t),r=n.type||"application/octet-stream",o=a(r);return e?!e.includes(".")&&o&&(e="".concat(e,".").concat(o)):e=i(o),new File([n],e,{type:r})},t.blobToBase64=u,t.blobToDataURL=l,t.blobToFile=function(t,e){var n=t.type||"application/octet-stream",r=a(n);return e?!e.includes(".")&&r&&(e="".concat(e,".").concat(r)):e=i(r),new File([t],e,{type:n})},t.checkFileType=function(t){var e="",n="";return"string"==typeof t?e=o(n=r(t)):(e=t.type||"",n=t.name?r(t.name):a(e)),{isImage:e.startsWith("image/"),isAudio:e.startsWith("audio/"),isVideo:e.startsWith("video/"),mimeType:e,extension:n}},t.dataURLToImage=f,t.dataURLtoBlob=p,t.dataURLtoFile=d,t.dataURLtoImgBlob=function(t){var e=p(t);if(!e.type.startsWith("image/"))throw new Error("提供的DataURL不是图片格式");return e},t.delay=function(t){return new Promise(function(e){return setTimeout(e,t)})},t.fileToBase64=function(t){return u(t)},t.fileToBlob=function(t){return new Blob([t],{type:t.type})},t.generateRandomFileName=i,t.getBase64FromDataURL=function(t){return t.split(",")[1]||""},t.getExtensionFromMimeType=a,t.getFileExtension=r,t.getMimeTypeFromDataURL=c,t.getMimeTypeFromExtension=o,t.imageToDataURL=function(t,e,n){void 0===e&&(e="jpeg"),void 0===n&&(n=.9);var r=document.createElement("canvas");r.width=t.naturalWidth||t.width,r.height=t.naturalHeight||t.height;var a=r.getContext("2d");if(!a)throw new Error("无法创建canvas 2d上下文");return a.drawImage(t,0,0),r.toDataURL("image/".concat(e),n)},t.imgCompress=function(t,r){return void 0===r&&(r={}),e(this,void 0,void 0,function(){var e,a,i,c,u,s,l,f,p,m,h,w,v,b;return n(this,function(n){switch(n.label){case 0:if(!t.type.startsWith("image/"))throw new Error("提供的文件不是图片格式");return e=r.quality,a=void 0===e?.8:e,i=r.maxWidth,c=r.maxHeight,u=r.format,s=t.type,u&&(s=o(u)||t.type),[4,g(t)];case 1:if(l=n.sent(),f=l.naturalWidth,p=l.naturalHeight,i&&f>i&&(p=p*i/f,f=i),c&&p>c&&(f=f*c/p,p=c),(m=document.createElement("canvas")).width=f,m.height=p,!(h=m.getContext("2d")))throw new Error("无法创建canvas 2d上下文");return h.drawImage(l,0,0,f,p),w=m.toDataURL(s,a),v=t.name,u&&(-1!==(b=v.lastIndexOf("."))&&(v=v.substring(0,b)),v="".concat(v,".").concat(u)),[2,d(w,v)]}})})},t.imgConvert=function(t,r){return e(this,void 0,void 0,function(){var e,a,i,c,u,s,l,f,p,m;return n(this,function(n){switch(n.label){case 0:if(!t.type.startsWith("image/"))throw new Error("提供的文件不是图片格式");if(e=r.format,a=r.quality,i=void 0===a?.9:a,!(c=o(e)))throw new Error("不支持的图片格式: ".concat(e));return[4,g(t)];case 1:if(u=n.sent(),(s=document.createElement("canvas")).width=u.naturalWidth,s.height=u.naturalHeight,!(l=s.getContext("2d")))throw new Error("无法创建canvas 2d上下文");return l.drawImage(u,0,0),f=s.toDataURL(c,i),p=t.name,-1!==(m=p.lastIndexOf("."))&&(p=p.substring(0,m)),p="".concat(p,".").concat(e),[2,d(f,p)]}})})},t.isBase64=function(t){if(!t||"string"!=typeof t)return!1;if(0===t.indexOf("data:"))return-1!==t.indexOf("base64");try{return btoa(atob(t))===t}catch(t){return!1}},t.isBlob=function(t){return t instanceof Blob},t.isFile=function(t){return t instanceof File},t.urlToBase64=function(t){return e(this,void 0,void 0,function(){var e;return n(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,fetch(t)];case 1:return[4,n.sent().blob()];case 2:return[4,u(n.sent())];case 3:return[2,n.sent()];case 4:throw e=n.sent(),new Error("URL转Base64失败: ".concat(e instanceof Error?e.message:String(e)));case 5:return[2]}})})},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
